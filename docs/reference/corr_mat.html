<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Correlation Matrix Used in Certain Weighting Schemes — corr_mat • mdepriv</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Correlation Matrix Used in Certain Weighting Schemes — corr_mat"><meta property="og:description" content='Returns the item correlation matrix (and when K dimensions have been specified, K matrices) that the function mdepriv internally generates
when the argument method = "bv" and the argument bv_corr_type = "mixed" or "pearson"
or when the argument wa is specified and the argument wb = "mixed" or "pearson".
Permits inspection of the correlation structure and can be used for complementary analytic purposes such as factor analysis or biplots.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mdepriv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mdepriv_get_started.html">Get Started with mdepriv</a>
    </li>
    <li>
      <a href="../articles/what_is_different_from_stata.html">What is different from Stata’s mdepriv?</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code"></span>
     
    Functions &amp; Datasets
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/a-benini/mdepriv/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correlation Matrix Used in Certain Weighting Schemes</h1>
    <small class="dont-index">Source: <a href="https://github.com/a-benini/mdepriv/blob/HEAD/R/corr_mat.R" class="external-link"><code>R/corr_mat.R</code></a></small>
    <div class="hidden name"><code>corr_mat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns the item correlation matrix (and when K dimensions have been specified, K matrices) that the function <code><a href="mdepriv.html">mdepriv</a></code> internally generates</p><ul><li><p>when the argument <code>method</code> = <code>"bv"</code> and the argument <code>bv_corr_type</code> = <code>"mixed"</code> or <code>"pearson"</code></p></li>
<li><p>or when the argument <code>wa</code> is specified and the argument <code>wb</code> = <code>"mixed"</code> or <code>"pearson"</code>.</p></li>
</ul><p>Permits inspection of the correlation structure and can be used for complementary analytic purposes such as factor analysis or biplots.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">corr_mat</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">items</span>,</span>
<span>  sampling_weights <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  corr_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mixed"</span>, <span class="st">"pearson"</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"type"</span>, <span class="st">"both"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a <code>data.frame</code> or a <code>matrix</code> with columns containing variables representing deprivation items measured on the [0,1] range.
Optionally a column with user defined sampling weights (s. argument <code>sampling_weights</code>) can be included.</p></dd>


<dt>items</dt>
<dd><p>a character string vector or list of such vectors specifying the indicators / items within the argument <code>data</code> from which the deprivation scores are derived.
If the user inputs a list with more than one vector, the items are grouped in dimensions.
By naming the list elements, the user defines the dimensions' names.
Else, dimensions are named by default <code>"Dimension 1"</code> to <code>"Dimension K"</code> where K is the number of dimensions.</p></dd>


<dt>sampling_weights</dt>
<dd><p>a character string corresponding to column heading of a numeric variable within the argument <code>data</code> which is specified as sampling weights.
By default set to <code>NA</code>, which means no specification of sampling weights.</p></dd>


<dt>corr_type</dt>
<dd><p>a character string selecting the correlation type.
Available choices are <code>"mixed"</code> (default) and <code>"pearson"</code>.
The option <code>"mixed"</code> detects automatically the appropriate correlation type <code>"pearson"</code>, <code>"polyserial"</code> or <code>"polychoric"</code> for each pair of items (s. Details).</p></dd>


<dt>output</dt>
<dd><p>a character string vector selecting the output. Available choices are <code>"numeric"</code> (default), <code>"type"</code> or <code>"both"</code>.
<code>"numeric"</code> delivers a numeric correlation matrix or list of such matrices.
(the latter if the <code>items</code> are grouped in more than one dimension).
<code>"type"</code> delivers the correlation type applied to each pair of items in a matrix, respectively list of matrices analog to the numeric output.
<code>"both"</code> combines the <code>"numeric"</code> and <code>"type"</code> as a list.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Either a single <code>matrix</code> or a <code>list</code> composed of several <code>matrix</code>es (s. argument <code>"output"</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The calculation of the correlation coefficient for a pair of items is based on the function <code><a href="https://american-institutes-for-research.github.io/wCorr/reference/weightedCorr.html" class="external-link">weightedCorr</a></code>.</p>
<p>When setting the argument <code>corr_type</code> to <code>"mixed"</code>
the appropriate correlation type <code>"pearson"</code>, <code>"polyserial"</code> or <code>"polychoric"</code>
is automatically detected for each pair of items by the following rules:</p><ul><li><p><code>"pearson"</code>: both items have &gt; 10 distinct values.</p></li>
<li><p><code>"polyserial"</code>: one item has \(\le\) 10, the other &gt; 10 distinct values.</p></li>
<li><p><code>"polychoric"</code>: both items have \(\le\) 10 distinct values.</p></li>
</ul><p>When the argument <code>corr_type</code> is set to <code>"pearson"</code> this correlation type is forced on all item pairs.</p>
<p>Depending on the correlation type(s) used, the matrix may not be positive semidefinite and therefore not immediately suitable for purposes such as factor analysis.
This is more likely to happen when some of the items are binary.
The function <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">nearPD</a></code> will produce the nearest positive definite matrix.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># data used for demonstration</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id y1 y2 y3  y4    y5    y6    y7 sampl_weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span> <span class="co"># default output: numeric</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4         y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.81597841  0.8574640  0.32881030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.8159784 1.00000000  0.8083585  0.05629782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8574640 0.80835852  1.0000000 -0.10943492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3288103 0.05629782 -0.1094349  1.00000000</span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y1           y4           y5           y6          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4         y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.81597841  0.8574640  0.32881030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.8159784 1.00000000  0.8083585  0.05629782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8574640 0.80835852  1.0000000 -0.10943492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3288103 0.05629782 -0.1094349  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y1           y4           y5           y6          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with sampling weights (3rd argument)</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, <span class="st">"sampl_weights"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4          y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.79871297  0.84893375  0.37055782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.7987130 1.00000000  0.81370895  0.04023532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8489338 0.81370895  1.00000000 -0.09680152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3705578 0.04023532 -0.09680152  1.00000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># choose correlation type</span></span></span>
<span class="r-in"><span><span class="va">corr_mat_default</span> <span class="op">&lt;-</span> <span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corr_mat_mixed</span> <span class="op">&lt;-</span> <span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, corr_type <span class="op">=</span> <span class="st">"mixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">corr_mat_default</span>, <span class="va">corr_mat_mixed</span><span class="op">)</span> <span class="co"># "mixed is corr_type's default</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># force a correlation type on all pairs of items</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, corr_type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4         y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.60056932  0.4629204  0.21372370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.6005693 1.00000000  0.6792278  0.07185579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.4629204 0.67922776  1.0000000 -0.10943492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.2137237 0.07185579 -0.1094349  1.00000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># grouping items in dimensions</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Dimension 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4         y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.81597841  0.8574640  0.32881030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.8159784 1.00000000  0.8083585  0.05629782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8574640 0.80835852  1.0000000 -0.10943492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3288103 0.05629782 -0.1094349  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Dimension 2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            y2          y3          y7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 1.00000000 0.064950690 0.060486856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 0.06495069 1.000000000 0.001620888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 0.06048686 0.001620888 1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># customized group / dimension labels</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"Group B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Group A`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4         y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.81597841  0.8574640  0.32881030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.8159784 1.00000000  0.8083585  0.05629782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8574640 0.80835852  1.0000000 -0.10943492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3288103 0.05629782 -0.1094349  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Group B`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            y2          y3          y7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 1.00000000 0.064950690 0.060486856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 0.06495069 1.000000000 0.001620888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 0.06048686 0.001620888 1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># mdepriv output / returns as template for corr_mat arguments</span></span></span>
<span class="r-in"><span><span class="co"># items grouped as dimensions</span></span></span>
<span class="r-in"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group X"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span>, <span class="st">"Group Z"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model: betti-verma ("bv"): correlation type = pearson, rhoH = NA (data driven)</span></span></span>
<span class="r-in"><span><span class="va">bv_pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">dim</span>, <span class="st">"sampl_weights"</span>,</span></span>
<span class="r-in"><span>                      method <span class="op">=</span> <span class="st">"bv"</span>, bv_corr_type <span class="op">=</span> <span class="st">"pearson"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use model output as arguments</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">bv_pearson</span><span class="op">$</span><span class="va">data</span>, <span class="va">bv_pearson</span><span class="op">$</span><span class="va">items</span>, <span class="va">bv_pearson</span><span class="op">$</span><span class="va">sampling_weights</span>,</span></span>
<span class="r-in"><span>         corr_type <span class="op">=</span> <span class="va">bv_pearson</span><span class="op">$</span><span class="va">wb</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric$`Group X`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4          y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.58315592  0.45257771  0.23819918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.5831559 1.00000000  0.68561919  0.05063697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.4525777 0.68561919  1.00000000 -0.09680152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.2381992 0.05063697 -0.09680152  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric$`Group Z`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            y2         y3         y7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 1.00000000 0.06293436 0.03891441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 0.06293436 1.00000000 0.01315840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 0.03891441 0.01315840 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type$`Group X`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y1        y4        y5        y6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 "pearson" "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 "pearson" "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 "pearson" "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 "pearson" "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type$`Group Z`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y2        y3        y7       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 "pearson" "pearson" "pearson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model: user defined double weighting</span></span></span>
<span class="r-in"><span><span class="co"># 1st factor = wa = "equal", 2nd factor = wa = "mixed" (correlation type),</span></span></span>
<span class="r-in"><span><span class="co"># rhoH = NA (data driven)</span></span></span>
<span class="r-in"><span><span class="va">eq_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">dim</span>, <span class="st">"sampl_weights"</span>,</span></span>
<span class="r-in"><span>                    wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use model output as arguments</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">eq_mixed</span><span class="op">$</span><span class="va">data</span>, <span class="va">eq_mixed</span><span class="op">$</span><span class="va">items</span>, <span class="va">eq_mixed</span><span class="op">$</span><span class="va">sampling_weights</span>,</span></span>
<span class="r-in"><span>         corr_type <span class="op">=</span> <span class="va">eq_mixed</span><span class="op">$</span><span class="va">wb</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric$`Group X`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4          y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.79871297  0.84893375  0.37055782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.7987130 1.00000000  0.81370895  0.04023532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8489338 0.81370895  1.00000000 -0.09680152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3705578 0.04023532 -0.09680152  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric$`Group Z`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            y2         y3         y7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 1.00000000 0.10363632 0.05015889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 0.10363632 1.00000000 0.01656435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 0.05015889 0.01656435 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type$`Group X`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y1           y4           y5           y6          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type$`Group Z`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    y2           y3           y7          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 "polychoric" "polychoric" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 "polychoric" "polychoric" "polyserial"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 "polyserial" "polyserial" "pearson"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model: user defined double weighting</span></span></span>
<span class="r-in"><span><span class="co"># 1st factor = wa = "bv", 2nd factator = wb = "diagonal"</span></span></span>
<span class="r-in"><span><span class="co"># (all off-diagonal correlations = 0), rhoH = NA (irrelvant)</span></span></span>
<span class="r-in"><span><span class="va">bv_diagonal</span> <span class="op">&lt;-</span> <span class="fu"><a href="mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">dim</span>, <span class="st">"sampl_weights"</span>,</span></span>
<span class="r-in"><span>                       wa <span class="op">=</span> <span class="st">"bv"</span>, wb <span class="op">=</span> <span class="st">"diagonal"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use model output as arguments</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">bv_diagonal</span><span class="op">$</span><span class="va">data</span>, <span class="va">bv_diagonal</span><span class="op">$</span><span class="va">items</span>, <span class="va">bv_diagonal</span><span class="op">$</span><span class="va">sampling_weights</span>,</span></span>
<span class="r-in"><span>         corr_type <span class="op">=</span> <span class="va">bv_diagonal</span><span class="op">$</span><span class="va">wb</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in match.arg(corr_type) : 'arg' should be one of “mixed”, “pearson”</span>
<span class="r-in"><span><span class="co"># triggers an error because:</span></span></span>
<span class="r-in"><span><span class="va">bv_diagonal</span><span class="op">$</span><span class="va">wb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "diagonal"</span>
<span class="r-in"><span><span class="co"># if corr_type is left as the default or set to a valid option, then ...</span></span></span>
<span class="r-in"><span><span class="fu">corr_mat</span><span class="op">(</span><span class="va">bv_diagonal</span><span class="op">$</span><span class="va">data</span>, <span class="va">bv_diagonal</span><span class="op">$</span><span class="va">items</span>, <span class="va">bv_diagonal</span><span class="op">$</span><span class="va">sampling_weights</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Group X`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           y1         y4          y5          y6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 1.0000000 0.79871297  0.84893375  0.37055782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y4 0.7987130 1.00000000  0.81370895  0.04023532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y5 0.8489338 0.81370895  1.00000000 -0.09680152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y6 0.3705578 0.04023532 -0.09680152  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Group Z`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            y2         y3         y7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y2 1.00000000 0.10363632 0.05015889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y3 0.10363632 1.00000000 0.01656435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y7 0.05015889 0.01656435 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># ...  it works</span></span></span>
<span class="r-in"><span><span class="co"># for the arguments data, items and sampling_weights the ...</span></span></span>
<span class="r-in"><span><span class="co"># ... corresponding mdepriv outputs are always valid</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot unique correlation values and their relation to rhoH</span></span></span>
<span class="r-in"><span><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span></span></span>
<span class="r-in"><span><span class="va">corr_mat</span>  <span class="op">&lt;-</span> <span class="fu">corr_mat</span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span><span class="op">)</span> <span class="co"># corr_type default: "mixed"</span></span></span>
<span class="r-in"><span><span class="va">rhoH</span>      <span class="op">&lt;-</span> <span class="fu"><a href="mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="st">"rhoH"</span><span class="op">)</span></span></span>
<span class="r-in"><span>             <span class="co"># bv_corr_type default: "mixed"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">corr_val</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">corr_mat</span><span class="op">)</span><span class="op">)</span> <span class="co"># sorted unique correlation values</span></span></span>
<span class="r-in"><span><span class="va">dist_rhoH_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">corr_val</span> <span class="op">-</span> <span class="va">rhoH</span><span class="op">)</span> <span class="co"># distance of corr. values to rhoH</span></span></span>
<span class="r-in"><span><span class="va">bounding_rhoH</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">dist_rhoH_corr</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dist_rhoH_corr</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="co"># TRUE if one of the two corr. values bounding rhoH else FALSE</span></span></span>
<span class="r-in"><span><span class="va">corr_val_col</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">bounding_rhoH</span>, <span class="st">"black"</span>, <span class="st">"gray"</span><span class="op">)</span> <span class="co"># colors for corr. values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">corr_val</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="va">corr_val_col</span>,</span></span>
<span class="r-in"><span>  border <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"correlation value [-1,+1]"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"sorted unique correlation values and rhoH"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">rhoH</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">rhoH</span> <span class="op">+</span> <span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"rhoH = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rhoH</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"left"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"correlation values\nbounding largest gap"</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">15</span>, pt.cex <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corr_mat-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Attilio Benini, Aldo Benini.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

