<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Correlation Matrix Used in Certain Weighting Schemes — corr_mat • mdepriv</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Correlation Matrix Used in Certain Weighting Schemes — corr_mat" />
<meta property="og:description" content="Returns the item correlation matrix (and when K dimensions have been specified, K matrices) that the function mdepriv internally generates
when the argument method = &quot;bv&quot; and the argument bv_corr_type = &quot;mixed&quot; or &quot;pearson&quot;
or when the argument wa is specified and the argument wb = &quot;mixed&quot; or &quot;pearson&quot;.
Permits inspection of the correlation structure and can be used for complementary analytic purposes such as factor analysis or biplots." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mdepriv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mdepriv_get_started.html">Get Started with mdepriv</a>
    </li>
    <li>
      <a href="../articles/what_is_different_from_stata.html">What is different from Stata’s mdepriv?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code"></span>
     
    Functions &amp; Datasets
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/a-benini/mdepriv/">
    <span class="fab fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correlation Matrix Used in Certain Weighting Schemes</h1>
    <small class="dont-index">Source: <a href='https://github.com/a-benini/mdepriv/blob/master/R/corr_mat.R'><code>R/corr_mat.R</code></a></small>
    <div class="hidden name"><code>corr_mat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns the item correlation matrix (and when K dimensions have been specified, K matrices) that the function <code><a href='mdepriv.html'>mdepriv</a></code> internally generates</p><ul>
<li><p>when the argument <code>method</code> = <code>"bv"</code> and the argument <code>bv_corr_type</code> = <code>"mixed"</code> or <code>"pearson"</code></p></li>
<li><p>or when the argument <code>wa</code> is specified and the argument <code>wb</code> = <code>"mixed"</code> or <code>"pearson"</code>.</p></li>
</ul><p>Permits inspection of the correlation structure and can be used for complementary analytic purposes such as factor analysis or biplots.</p>
    </div>

    <pre class="usage"><span class='fu'>corr_mat</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>items</span>,
  sampling_weights <span class='op'>=</span> <span class='cn'>NA</span>,
  corr_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mixed"</span>, <span class='st'>"pearson"</span><span class='op'>)</span>,
  output <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"numeric"</span>, <span class='st'>"type"</span>, <span class='st'>"both"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a <code>data.frame</code> or a <code>matrix</code> with columns containing variables representing deprivation items measured on the [0,1] range.
Optionally a column with user defined sampling weights (s. argument <code>sampling_weights</code>) can be included.</p></td>
    </tr>
    <tr>
      <th>items</th>
      <td><p>a character string vector or list of such vectors specifying the indicators / items within the argument <code>data</code> from which the deprivation scores are derived.
If the user inputs a list with more than one vector, the items are grouped in dimensions.
By naming the list elements, the user defines the dimensions' names.
Else, dimensions are named by default <code>"Dimension 1"</code> to <code>"Dimension K"</code> where K is the number of dimensions.</p></td>
    </tr>
    <tr>
      <th>sampling_weights</th>
      <td><p>a character string corresponding to column heading of a numeric variable within the argument <code>data</code> which is specified as sampling weights.
By default set to <code>NA</code>, which means no specification of sampling weights.</p></td>
    </tr>
    <tr>
      <th>corr_type</th>
      <td><p>a character string selecting the correlation type.
Available choices are <code>"mixed"</code> (default) and <code>"pearson"</code>.
The option <code>"mixed"</code> detects automatically the appropriate correlation type <code>"pearson"</code>, <code>"polyserial"</code> or <code>"polychoric"</code> for each pair of items (s. Details).</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>a character string vector selecting the output. Available choices are <code>"numeric"</code> (default), <code>"type"</code> or <code>"both"</code>.
<code>"numeric"</code> delivers a numeric correlation matrix or list of such matrices.
(the latter if the <code>items</code> are grouped in more than one dimension).
<code>"type"</code> delivers the correlation type applied to each pair of items in a matrix, respectively list of matrices analog to the numeric output.
<code>"both"</code> combines the <code>"numeric"</code> and <code>"type"</code> as a list.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Either a single <code>matrix</code> or a <code>list</code> composed of several <code>matrix</code>es (s. argument <code>"output"</code>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The calculation of the correlation coefficient for a pair of items is based on the function <code><a href='https://american-institutes-for-research.github.io/wCorr/reference/weightedCorr.html'>weightedCorr</a></code>.</p>
<p>When setting the argument <code>corr_type</code> to <code>"mixed"</code>
the appropriate correlation type <code>"pearson"</code>, <code>"polyserial"</code> or <code>"polychoric"</code>
is automatically detected for each pair of items by the following rules:</p><ul>
<li><p><code>"pearson"</code>: both items have &gt; 10 distinct values.</p></li>
<li><p><code>"polyserial"</code>: one item has \(\le\) 10, the other &gt; 10 distinct values.</p></li>
<li><p><code>"polychoric"</code>: both items have \(\le\) 10 distinct values.</p></li>
</ul><p>When the argument <code>corr_type</code> is set to <code>"pearson"</code> this correlation type is forced on all item pairs.</p>
<p>Depending on the correlation type(s) used, the matrix may not be positive semidefinite and therefore not immediately suitable for purposes such as factor analysis.
This is more likely to happen when some of the items are binary.
The function <code><a href='https://rdrr.io/pkg/Matrix/man/nearPD.html'>nearPD</a></code> will produce the nearest positive definite matrix.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='co'># data used for demonstration</span>
</div><div class='output co'>#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights
#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556
#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500
#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973</div><div class='input'>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># default output: numeric</span>
</div><div class='output co'>#&gt;           y1         y4         y5          y6
#&gt; y1 1.0000000 0.81597841  0.8574640  0.32881030
#&gt; y4 0.8159784 1.00000000  0.8083585  0.05629782
#&gt; y5 0.8574640 0.80835852  1.0000000 -0.10943492
#&gt; y6 0.3288103 0.05629782 -0.1094349  1.00000000</div><div class='input'><span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, output <span class='op'>=</span> <span class='st'>"type"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    y1           y4           y5           y6          
#&gt; y1 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y4 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y5 "polyserial" "polyserial" "pearson"    "pearson"   
#&gt; y6 "polyserial" "polyserial" "pearson"    "pearson"   </div><div class='input'><span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, output <span class='op'>=</span> <span class='st'>"both"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $numeric
#&gt;           y1         y4         y5          y6
#&gt; y1 1.0000000 0.81597841  0.8574640  0.32881030
#&gt; y4 0.8159784 1.00000000  0.8083585  0.05629782
#&gt; y5 0.8574640 0.80835852  1.0000000 -0.10943492
#&gt; y6 0.3288103 0.05629782 -0.1094349  1.00000000
#&gt; 
#&gt; $type
#&gt;    y1           y4           y5           y6          
#&gt; y1 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y4 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y5 "polyserial" "polyserial" "pearson"    "pearson"   
#&gt; y6 "polyserial" "polyserial" "pearson"    "pearson"   
#&gt; </div><div class='input'>
<span class='co'># with sampling weights (3rd argument)</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, <span class='st'>"sampl_weights"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           y1         y4          y5          y6
#&gt; y1 1.0000000 0.79871297  0.84893375  0.37055782
#&gt; y4 0.7987130 1.00000000  0.81370895  0.04023532
#&gt; y5 0.8489338 0.81370895  1.00000000 -0.09680152
#&gt; y6 0.3705578 0.04023532 -0.09680152  1.00000000</div><div class='input'>
<span class='co'># choose correlation type</span>
<span class='va'>corr_mat_default</span> <span class='op'>&lt;-</span> <span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>corr_mat_mixed</span> <span class='op'>&lt;-</span> <span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, corr_type <span class='op'>=</span> <span class='st'>"mixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>corr_mat_default</span>, <span class='va'>corr_mat_mixed</span><span class='op'>)</span> <span class='co'># "mixed is corr_type's default</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># force a correlation type on all pairs of items</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, corr_type <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           y1         y4         y5          y6
#&gt; y1 1.0000000 0.60056932  0.4629204  0.21372370
#&gt; y4 0.6005693 1.00000000  0.6792278  0.07185579
#&gt; y5 0.4629204 0.67922776  1.0000000 -0.10943492
#&gt; y6 0.2137237 0.07185579 -0.1094349  1.00000000</div><div class='input'>
<span class='co'># grouping items in dimensions</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y2"</span>, <span class='st'>"y3"</span>, <span class='st'>"y7"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`Dimension 1`
#&gt;           y1         y4         y5          y6
#&gt; y1 1.0000000 0.81597841  0.8574640  0.32881030
#&gt; y4 0.8159784 1.00000000  0.8083585  0.05629782
#&gt; y5 0.8574640 0.80835852  1.0000000 -0.10943492
#&gt; y6 0.3288103 0.05629782 -0.1094349  1.00000000
#&gt; 
#&gt; $`Dimension 2`
#&gt;            y2          y3          y7
#&gt; y2 1.00000000 0.064950690 0.060486856
#&gt; y3 0.06495069 1.000000000 0.001620888
#&gt; y7 0.06048686 0.001620888 1.000000000
#&gt; </div><div class='input'><span class='co'># customized group / dimension labels</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"Group A"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>,
                          <span class='st'>"Group B"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y2"</span>, <span class='st'>"y3"</span>, <span class='st'>"y7"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`Group A`
#&gt;           y1         y4         y5          y6
#&gt; y1 1.0000000 0.81597841  0.8574640  0.32881030
#&gt; y4 0.8159784 1.00000000  0.8083585  0.05629782
#&gt; y5 0.8574640 0.80835852  1.0000000 -0.10943492
#&gt; y6 0.3288103 0.05629782 -0.1094349  1.00000000
#&gt; 
#&gt; $`Group B`
#&gt;            y2          y3          y7
#&gt; y2 1.00000000 0.064950690 0.060486856
#&gt; y3 0.06495069 1.000000000 0.001620888
#&gt; y7 0.06048686 0.001620888 1.000000000
#&gt; </div><div class='input'>
<span class='co'># mdepriv output / returns as template for corr_mat arguments</span>
<span class='co'># items grouped as dimensions</span>
<span class='va'>dim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"Group X"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span><span class='op'>)</span>, <span class='st'>"Group Z"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y2"</span>, <span class='st'>"y3"</span>, <span class='st'>"y7"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># model: betti-verma ("bv"): correlation type = pearson, rhoH = NA (data driven)</span>
<span class='va'>bv_pearson</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mdepriv.html'>mdepriv</a></span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='va'>dim</span>, <span class='st'>"sampl_weights"</span>,
                      method <span class='op'>=</span> <span class='st'>"bv"</span>, bv_corr_type <span class='op'>=</span> <span class='st'>"pearson"</span>, output <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span>
<span class='co'># use model output as arguments</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>bv_pearson</span><span class='op'>$</span><span class='va'>data</span>, <span class='va'>bv_pearson</span><span class='op'>$</span><span class='va'>items</span>, <span class='va'>bv_pearson</span><span class='op'>$</span><span class='va'>sampling_weights</span>,
         corr_type <span class='op'>=</span> <span class='va'>bv_pearson</span><span class='op'>$</span><span class='va'>wb</span>, output <span class='op'>=</span> <span class='st'>"both"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $numeric
#&gt; $numeric$`Group X`
#&gt;           y1         y4          y5          y6
#&gt; y1 1.0000000 0.58315592  0.45257771  0.23819918
#&gt; y4 0.5831559 1.00000000  0.68561919  0.05063697
#&gt; y5 0.4525777 0.68561919  1.00000000 -0.09680152
#&gt; y6 0.2381992 0.05063697 -0.09680152  1.00000000
#&gt; 
#&gt; $numeric$`Group Z`
#&gt;            y2         y3         y7
#&gt; y2 1.00000000 0.06293436 0.03891441
#&gt; y3 0.06293436 1.00000000 0.01315840
#&gt; y7 0.03891441 0.01315840 1.00000000
#&gt; 
#&gt; 
#&gt; $type
#&gt; $type$`Group X`
#&gt;    y1        y4        y5        y6       
#&gt; y1 "pearson" "pearson" "pearson" "pearson"
#&gt; y4 "pearson" "pearson" "pearson" "pearson"
#&gt; y5 "pearson" "pearson" "pearson" "pearson"
#&gt; y6 "pearson" "pearson" "pearson" "pearson"
#&gt; 
#&gt; $type$`Group Z`
#&gt;    y2        y3        y7       
#&gt; y2 "pearson" "pearson" "pearson"
#&gt; y3 "pearson" "pearson" "pearson"
#&gt; y7 "pearson" "pearson" "pearson"
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># model: user defined double weighting</span>
<span class='co'># 1st factor = wa = "equal", 2nd factor = wa = "mixed" (correlation type),</span>
<span class='co'># rhoH = NA (data driven)</span>
<span class='va'>eq_mixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mdepriv.html'>mdepriv</a></span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='va'>dim</span>, <span class='st'>"sampl_weights"</span>,
                    wa <span class='op'>=</span> <span class='st'>"equal"</span>, wb <span class='op'>=</span> <span class='st'>"mixed"</span>, output <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span>
<span class='co'># use model output as arguments</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>eq_mixed</span><span class='op'>$</span><span class='va'>data</span>, <span class='va'>eq_mixed</span><span class='op'>$</span><span class='va'>items</span>, <span class='va'>eq_mixed</span><span class='op'>$</span><span class='va'>sampling_weights</span>,
         corr_type <span class='op'>=</span> <span class='va'>eq_mixed</span><span class='op'>$</span><span class='va'>wb</span>, output <span class='op'>=</span> <span class='st'>"both"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $numeric
#&gt; $numeric$`Group X`
#&gt;           y1         y4          y5          y6
#&gt; y1 1.0000000 0.79871297  0.84893375  0.37055782
#&gt; y4 0.7987130 1.00000000  0.81370895  0.04023532
#&gt; y5 0.8489338 0.81370895  1.00000000 -0.09680152
#&gt; y6 0.3705578 0.04023532 -0.09680152  1.00000000
#&gt; 
#&gt; $numeric$`Group Z`
#&gt;            y2         y3         y7
#&gt; y2 1.00000000 0.10363632 0.05015889
#&gt; y3 0.10363632 1.00000000 0.01656435
#&gt; y7 0.05015889 0.01656435 1.00000000
#&gt; 
#&gt; 
#&gt; $type
#&gt; $type$`Group X`
#&gt;    y1           y4           y5           y6          
#&gt; y1 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y4 "polychoric" "polychoric" "polyserial" "polyserial"
#&gt; y5 "polyserial" "polyserial" "pearson"    "pearson"   
#&gt; y6 "polyserial" "polyserial" "pearson"    "pearson"   
#&gt; 
#&gt; $type$`Group Z`
#&gt;    y2           y3           y7          
#&gt; y2 "polychoric" "polychoric" "polyserial"
#&gt; y3 "polychoric" "polychoric" "polyserial"
#&gt; y7 "polyserial" "polyserial" "pearson"   
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># model: user defined double weighting</span>
<span class='co'># 1st factor = wa = "bv", 2nd factator = wb = "diagonal"</span>
<span class='co'># (all off-diagonal correlations = 0), rhoH = NA (irrelvant)</span>
<span class='va'>bv_diagonal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mdepriv.html'>mdepriv</a></span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='va'>dim</span>, <span class='st'>"sampl_weights"</span>,
                       wa <span class='op'>=</span> <span class='st'>"bv"</span>, wb <span class='op'>=</span> <span class='st'>"diagonal"</span>, output <span class='op'>=</span> <span class='st'>"all"</span><span class='op'>)</span>
<span class='co'># use model output as arguments</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>data</span>, <span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>items</span>, <span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>sampling_weights</span>,
         corr_type <span class='op'>=</span> <span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>wb</span>, output <span class='op'>=</span> <span class='st'>"both"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># would trigger an error because:</span>
<span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>wb</span>
</div><div class='output co'>#&gt; [1] "diagonal"</div><div class='input'><span class='co'># if corr_type is left as the default or set to a valid option, then ...</span>
<span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>data</span>, <span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>items</span>, <span class='va'>bv_diagonal</span><span class='op'>$</span><span class='va'>sampling_weights</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`Group X`
#&gt;           y1         y4          y5          y6
#&gt; y1 1.0000000 0.79871297  0.84893375  0.37055782
#&gt; y4 0.7987130 1.00000000  0.81370895  0.04023532
#&gt; y5 0.8489338 0.81370895  1.00000000 -0.09680152
#&gt; y6 0.3705578 0.04023532 -0.09680152  1.00000000
#&gt; 
#&gt; $`Group Z`
#&gt;            y2         y3         y7
#&gt; y2 1.00000000 0.10363632 0.05015889
#&gt; y3 0.10363632 1.00000000 0.01656435
#&gt; y7 0.05015889 0.01656435 1.00000000
#&gt; </div><div class='input'><span class='co'># ...  it works</span>
<span class='co'># for the arguments data, items and sampling_weights the ...</span>
<span class='co'># ... corresponding mdepriv outputs are always valid</span>

<span class='co'># plot unique correlation values and their relation to rhoH</span>
<span class='va'>items_sel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1"</span>, <span class='st'>"y4"</span>, <span class='st'>"y5"</span>, <span class='st'>"y6"</span>, <span class='st'>"y2"</span>, <span class='st'>"y3"</span>, <span class='st'>"y7"</span><span class='op'>)</span> <span class='co'># a selection of items</span>
<span class='va'>corr_mat</span>  <span class='op'>&lt;-</span> <span class='fu'>corr_mat</span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='va'>items_sel</span><span class='op'>)</span> <span class='co'># corr_type default: "mixed"</span>
<span class='va'>rhoH</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='mdepriv.html'>mdepriv</a></span><span class='op'>(</span><span class='va'>simul_data</span>, <span class='va'>items_sel</span>, method <span class='op'>=</span> <span class='st'>"bv"</span>, output <span class='op'>=</span> <span class='st'>"rhoH"</span><span class='op'>)</span>
             <span class='co'># bv_corr_type default: "mixed"</span>

<span class='va'>corr_val</span>       <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>corr_mat</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># sorted unique correlation values</span>
<span class='va'>dist_rhoH_corr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>corr_val</span> <span class='op'>-</span> <span class='va'>rhoH</span><span class='op'>)</span> <span class='co'># distance of corr. values to rhoH</span>
<span class='va'>bounding_rhoH</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>dist_rhoH_corr</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>dist_rhoH_corr</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>10</span><span class='op'>^</span><span class='op'>-</span><span class='fl'>10</span>
<span class='co'># TRUE if one of the two corr. values bounding rhoH else FALSE</span>
<span class='va'>corr_val_col</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>bounding_rhoH</span>, <span class='st'>"black"</span>, <span class='st'>"gray"</span><span class='op'>)</span> <span class='co'># colors for corr. values</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>corr_val</span>,
  col <span class='op'>=</span> <span class='va'>corr_val_col</span>,
  border <span class='op'>=</span> <span class='cn'>NA</span>,
  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.2</span>, <span class='fl'>1</span><span class='op'>)</span>,
  ylab <span class='op'>=</span> <span class='st'>"correlation value [-1,+1]"</span>,
  main <span class='op'>=</span> <span class='st'>"sorted unique correlation values and rhoH"</span>
<span class='op'>)</span>
</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>rhoH</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, lwd <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>rhoH</span> <span class='op'>+</span> <span class='fl'>0.05</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"rhoH = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>rhoH</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>, adj <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"left"</span>,
  <span class='st'>"correlation values\nbounding largest gap"</span>,
  col <span class='op'>=</span> <span class='st'>"black"</span>, pch <span class='op'>=</span> <span class='fl'>15</span>, pt.cex <span class='op'>=</span> <span class='fl'>2</span>, bty <span class='op'>=</span> <span class='st'>"n"</span>
<span class='op'>)</span>
</div><div class='img'><img src='corr_mat-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Attilio Benini, Aldo Benini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


