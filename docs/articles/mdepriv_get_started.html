<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get Started with mdepriv • mdepriv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with mdepriv">
<meta property="og:description" content="mdepriv">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mdepriv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mdepriv_get_started.html">Get Started with mdepriv</a>
    </li>
    <li>
      <a href="../articles/what_is_different_from_stata.html">What is different from Stata’s mdepriv?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code"></span>
     
    Functions &amp; Datasets
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/a-benini/mdepriv/">
    <span class="fab fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mdepriv_get_started_files/header-attrs-2.8/header-attrs.js"></script><script src="mdepriv_get_started_files/kePrint-0.0.1/kePrint.js"></script><link href="mdepriv_get_started_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get Started with mdepriv</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/a-benini/mdepriv/blob/master/vignettes/mdepriv_get_started.Rmd"><code>vignettes/mdepriv_get_started.Rmd</code></a></small>
      <div class="hidden name"><code>mdepriv_get_started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The package mdepriv translates the homonymous Stata command <a href="http://medim.ceps.lu/stata/mdepriv_v3.pdf">(Pi Alperin &amp; Van Kerm, 2009)</a> for R users.</p>
<p>mdepriv offers four methods to calculate synthetic scores of multiple deprivation from unidimensional indicators and/or basic items of deprivation. While it originated in the field of poverty research, it is equally suitable for measures of the severity of humanitarian conditions.</p>
<p>The methods offer a range from simple aggregation of equally weighted indicators to more involved ones that take into account desired traits of deprivation and severity indices. The user has the option to 1. penalize redundant items / indicators with lower weights and/or 2. to reward better discriminating ones with higher weights - or neither. All methods generate unit-level deprivation / severity scores that are linear combinations of the items / indicators, with their weights designed to sum to one. They return user-defined selections of output elements, with the aggregate deprivation level and a table of item / indicator means, weights and contributions to the aggregate deprivation / severity as the default.</p>
<p>mdepriv accepts indicators and items standardized to the interval [0,1]. It does not accept arguments with missing values; such observations have to be removed from the dataframe or matrix input beforehand. All items / indicators have to be oriented negatively (higher values denote less desirable states).</p>
<p>Fundamentally, the four methods</p>
<ul>
<li>Equi-proportionate</li>
<li>Desai &amp; Shah (1988)</li>
<li>Cerioli &amp; Zani (1990)</li>
<li>Betti &amp; Verma (1998)</li>
</ul>
<p>differ by their increasing sensitivity to deprivations / adverse conditions suffered by the poorest / most oppressed units (individuals, households, communities). The idea is to weight more strongly specific deprivations / adverse conditions that the more advantaged units have overcome, but which are still afflicting those at the bottom. Typically, in poverty studies, this makes good sense with durable household assets, which are observed as dichotomous “has / does not have” and recorded as binary (0/1) variables.</p>
<p>In humanitarian assessments it is less common that the severity of a lacking / suffering / threat is inversely proportionate to its prevalence. When prevalence-dependent weighting is not appropriate, mdepriv gives the user three options:</p>
<ol style="list-style-type: decimal">
<li>Equi-proportionate weighting</li>
<li>Unequal weights chosen for substantive considerations</li>
<li>Switching off prevalence-sensitivity</li>
</ol>
<p>This third option is meaningful primarily in combination with the Betti-Verma method. This method deserves particular attention. Its defining feature is a double-weighting algorithm:</p>
<ul>
<li>The first weighting factor gauges the discriminating power of an item / indicator through its coefficient of variation (= standard deviation / mean). For dichotomous items / indicators, this implies high sensitivity to prevalence (the C.o.V. grows exponentially as the proportion tends towards zero). For continuous ones, higher C.o.V.s imply higher information content.</li>
<li>The second weighting factor results from the correlations among the items / indicators. Those correlated strongly positively with most others are considered more highly redundant and are penalized with lower weights. Those with comparatively low positive or negative sums of correlation coefficients are considered capturing more unique aspects of deprivation / humanitarian conditions and are rewarded with higher weights.</li>
</ul>
<p>Betti-Verma is the only one among the four methods sensitive to the information content of continuous items / indicators. mdepriv automatically computes the weight of each item / indicator proportionate to the product of its two weighting factors.</p>
<p><a name="reason_wa_wb"></a> The <code>mdepriv</code> function makes the second weighting factor available also for the other three methods, but not all combinations are practically meaningful. <code>mdepriv</code> automatically recognizes the appropriate type of correlations between pairs of items / indicators, but the user can impose a particular type collectively on all pairs (rarely meaningful!). When the user opts for double-weighting (other than in Betti-Verma, where it is the default), the options have to be specified for both factors. <code>mdepriv</code> notation for the first factor is <code>wa</code>, for the second it is <code>wb</code>. However, not all combinations are practically meaningful. Recommended combinations depend on the analytic objective. Plausibly, the most relevant are:</p>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Objective
</th>
<th style="text-align:left;">
First weighting factor (wa)
</th>
<th style="text-align:left;">
Second weighting factor (wb)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Indifferent to prevalence (dichotomous items) and to information content (continuous). But controlling for redundancy is important.
</td>
<td style="text-align:left;">
Equi-proportionate
</td>
<td style="text-align:left;">
on
</td>
</tr>
<tr>
<td style="text-align:left;">
Items are all dichotomous. Limited sensitivity to low prevalence desired. Not controlling for redundancy.
</td>
<td style="text-align:left;">
Desai-Shah
</td>
<td style="text-align:left;">
off
</td>
</tr>
<tr>
<td style="text-align:left;">
Items are all dichotomous. High sensitivity to low prevalence desired. Not controlling for redundancy.
</td>
<td style="text-align:left;">
Betti-Verma
</td>
<td style="text-align:left;">
off
</td>
</tr>
<tr>
<td style="text-align:left;">
All items are continuous, and controlling for redundancy is important.
</td>
<td style="text-align:left;">
Betti-Verma
</td>
<td style="text-align:left;">
on
</td>
</tr>
<tr>
<td style="text-align:left;">
Items are mixed dichotomous / continuous. Indifferent to prevalence of the dichotomous, but concerned for information content of the continuous. Redundancy control is important. i.e. Two-level deprivation / severity model:
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Level 1: Combine all dichotomous items, save scores as one more continuous indicator for the second level.
</td>
<td style="text-align:left;">
Equi-proportionate
</td>
<td style="text-align:left;">
on
</td>
</tr>
<tr>
<td style="text-align:left;">
Level 2: Combine continuous items and indicator saved from first level. Produces aggregate deprivation / severity statistic.
</td>
<td style="text-align:left;">
Betti-Verma
</td>
<td style="text-align:left;">
on
</td>
</tr>
</tbody>
</table>
<p>The Cerioli-Zani model appears to be primarily of historic interest. It was one of the first to pursue the so-called fuzzy-set approach to multi-dimensional poverty measurement, which Betti and Verma subsequently deepened. The interested user may consult the reader edited by Lemmi and Betti (2006), but familiarity with fuzzy sets is not required for the understanding and application of mdepriv.</p>
<p>As a final introductory remark, it should be said that the Betti-Verma method is particularly appropriate when a concept (deprivation, severity of conditions, etc.) has many aspects, its dimensionality is not well understood, and classical methods to unravel the dimensions (e.g., factor analysis) are likely distorted by redundancies among the available indicators.</p>
<p>The following focuses on the technical handling of the <code>mdepriv</code> package. Context and rationale are not discussed here. The purpose is to walk the user through the manifold arguments and outputs of the core function <code>mdepriv</code>. Familiarity with the basics of R is presumed. Still, things are kept at a pretty low skill level so that users with little R experience can follow. The code provided is intended as copy-and-paste material, which users can modify for practice or for real-world data analysis.</p>
<p>Chiefly we will use the simulated dataset <code>simul_data</code> with 100 observations, which are enough to demonstrate functionality. To showcase a <a href="#two-level-model">two-level deprivation model</a> we put the dataset <code>MSNA_HC</code> to use. Both datasets are part of the <code>mdepriv</code>-package; thus they do not require further sourcing.</p>
</div>
<div id="requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h2>
<p>Packages used in the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install package devtools if not yet installed</span>
<span class="co"># install.packages("devtools")</span>

<span class="co"># install fast from GitHub without vignettes (not recommanded)</span>
<span class="co"># devtools::install_github("a-benini/mdepriv")</span>

<span class="co"># recommended: installation at a slower pace from GitHub including vignettes:</span>
<span class="co"># pkgs_4_vignettes &lt;- c("tidyverse", "kableExtra", "knitr", "rmarkdown", "visdat")</span>
<span class="co"># packages required to build mdepriv's vignettes from GitHup repository</span>
<span class="co"># new_pkgs_4_vignettes &lt;- pkgs_4_vignettes[!pkgs_4_vignettes %in% installed.packages()]</span>
<span class="co"># among these packages the ones not yet installed</span>
<span class="co"># if(length(new_pkgs_4_vignettes) &gt; 0){install.packages(new_pkgs_4_vignettes)}</span>
<span class="co"># install the still missing packages</span>
<span class="co"># devtools::install_github("a-benini/mdepriv", build_vignettes = TRUE)</span>
<span class="co"># install mdepriv from GitHup with its vignettes</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/a-benini/mdepriv">mdepriv</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"mdepriv"</span><span class="op">)</span> <span class="co"># mdepriv package documentation</span>

<span class="co"># install.packages("tidyverse")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># includes packages for data handling and graphics</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✓ ggplot2 3.3.3     ✓ purrr   0.3.4</span>
<span class="co">#&gt; ✓ tibble  3.1.1     ✓ dplyr   1.0.6</span>
<span class="co">#&gt; ✓ tidyr   1.1.3     ✓ stringr 1.4.0</span>
<span class="co">#&gt; ✓ readr   1.4.0     ✓ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; x dplyr::filter()     masks stats::filter()</span>
<span class="co">#&gt; x dplyr::group_rows() masks kableExtra::group_rows()</span>
<span class="co">#&gt; x dplyr::lag()        masks stats::lag()</span>

<span class="co"># install.packages("visdat")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://visdat.njtierney.com/">visdat</a></span><span class="op">)</span> <span class="co"># package for preliminary visualisation of data</span></code></pre></div>
</div>
<div id="a-minimalist-start" class="section level2">
<h2 class="hasAnchor">
<a href="#a-minimalist-start" class="anchor"></a>A Minimalist Start</h2>
<p>When using the function <code>mdepriv</code> to calculate synthetic scores of multiple deprivations, at a minimum the first two of its arguments - <code>data</code> and <code>items</code> - need to be specified. The former is a <code>data.frame</code> or <code>matrix</code> containing the items as columns. The later contains the column headings of the items of interest as character strings.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simul_data</span>, items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $aggregate_deprivation_level</span>
<span class="co">#&gt; [1] 0.299315</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_item</span>
<span class="co">#&gt;    Item   Index    Weight     Contri     Share</span>
<span class="co">#&gt; 1    y1 0.16000 0.4118528 0.06589645 0.2201575</span>
<span class="co">#&gt; 2    y3 0.53000 0.1426820 0.07562147 0.2526484</span>
<span class="co">#&gt; 3    y4 0.27600 0.2893190 0.07985203 0.2667826</span>
<span class="co">#&gt; 4    y7 0.49918 0.1561462 0.07794506 0.2604115</span>
<span class="co">#&gt; 5 Total      NA 1.0000000 0.29931501 1.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_scores</span>
<span class="co">#&gt;   N_Obs.     Mean Std._Dev. Min Max</span>
<span class="co">#&gt; 1    100 0.299315 0.2437652   0   1</span></code></pre></div>
<p>The above call generates four <a href="#what-mdepriv-can-return">default output elements</a>. The effective weighting scheme is flagged. The aggregate deprivation level is printed out to several digits; for comparisons two informative ones are usually enough. The summary by item is the key output. The index is the proportion of a binary item or the mean of a continuous one. The weights sum to one. The item-wise contributions are the products of the respective indices and weights. Their sum is the aggregate deprivation / severity level. The shares are the relative contributions, such that they sum to one. The summary scores returns minimal descriptive statistics of the <a href="#obtaining-the-scores">scores</a>, which are the unit-level synthetic deprivation values. The mean score, by design, is identical with the total of contributions and the aggregate deprivation level.</p>
<p>As long as the arguments are specified in the correct order, it’s not necessary to write them out:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simul_data</span>, items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span>
<span class="va">lazy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">tidy</span>, <span class="va">lazy</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="what-mdepriv-can-return" class="section level2">
<h2 class="hasAnchor">
<a href="#what-mdepriv-can-return" class="anchor"></a>What mdepriv Can Return</h2>
<p><code>mdepriv</code>‘s returns can be selected by the multiple choice argument <code>output</code>. The <code>output</code> options <code>"view"</code> and <code>"all"</code> are wrappers for <code>output</code>-compilations (s. <a href="#tab_output">below</a>), the former being <code>output</code>’s default setting. If <code>output</code> consists of a single element, a single object is returned as such. Multiple returns are gathered in a named <code>list</code>. For more detailed information on the returns have a look at the section ’Value’ on <code>mepriv</code>’s help page.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="st">"mdepriv"</span><span class="op">)</span></code></pre></div>
<a name="tab_output"></a>
<table class="table table">
<caption style="font-size: initial !important;">
mdepriv output options
</caption>
<thead><tr>
<th style="text-align:left;">
possible output element
</th>
<th style="text-align:center;">
included in view
</th>
<th style="text-align:center;">
included in all
</th>
<th style="text-align:left;">
class / object type
</th>
<th style="text-align:center;">
useable as argument in other models
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
weighting_scheme
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single character string
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
aggregate_deprivation_level
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single numeric value
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
summary_by_dimension
</td>
<td style="text-align:center;">
X(*)
</td>
<td style="text-align:center;">
X(*)
</td>
<td style="text-align:left;">
data.frame
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
summary_by_item
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
data.frame
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
summary_scores
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
data.frame
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
score_i
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
numeric vector
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
sum_sampling_weights
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single numeric value
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
</td>
</tr>
<tr>
<td style="text-align:left;">
data
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
data.frame
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
items
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
list
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
sampling_weights
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single character string
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
wa
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single character string
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
wb
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single character string
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
rhoH
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single numeric value
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
user_def_weights
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
list or single NA-value
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
score_i_heading
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:left;">
single character string
</td>
<td style="text-align:center;width: 1in; max-width: 5.5in; ">
X
</td>
</tr>
</tbody>
</table>
<p>The output elements re-usable as arguments in subsequent models (s. <a href="#tab_output">above</a>) retain the model settings effectively used, either by default or user-specified. How these settings are passed on to other models is shown by the examples <a href="#reuse_itmes">of <code>items</code></a> and <a href="#reuse_data">of <code>data</code></a>. The <code>output</code> elements <code>"weighting_scheme"</code>, <code>"wa"</code>, <code>"wb"</code>, <code>"rhoH"</code> and <code>"user_def_weights"</code> can be used to <a href="#check-the-weighting-scheme">check the specifics of the applied weighting scheme</a>. Rationale and the how-to of recycling <code>"wa"</code>, <code>"wb"</code>, <code>"rhoH"</code> or <code>"user_def_weights"</code> are given <a href="#re_use_weighting_scheme">here</a>.</p>
<p>X(*): Unless two or more <a href="#grouping-items-as-dimensions">dimensions</a> have been specified, the <code>data.frame</code> <code>summary_by_dimension</code> is dropped from the <code>output</code>-compilations <code>"view"</code> and <code>"all"</code>. In these cases also the column <code>Dimension</code> is dropped from the <code>data.frame</code> <code>summary_by_item</code>. This makes the output more compact. However, when processing returns of several <code>mdepriv</code>-models, some with, others without dimension-specification, a homogenous output structure may be advantageous <a href="#models_with_without_dim">(s. below)</a>. The <code>summary_by_dimension</code>-table, respectively the column <code>Dimension</code> in the <code>summary_by_item</code>-table can be enforced by explicitly specifying <code>"summary_by_dimension"</code> as an <code>output</code>-element:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"view"</span>, <span class="st">"summary_by_dimension"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $aggregate_deprivation_level</span>
<span class="co">#&gt; [1] 0.3113771</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_dimension</span>
<span class="co">#&gt;     Dimension N_Item     Index Weight    Contri Share</span>
<span class="co">#&gt; 1 Dimension 1      3 0.3113771      1 0.3113771     1</span>
<span class="co">#&gt; 2       Total      3        NA      1 0.3113771     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_item</span>
<span class="co">#&gt;     Dimension Item Index    Weight     Contri     Share</span>
<span class="co">#&gt; 1 Dimension 1   y1  0.16 0.6489002 0.10382403 0.3334350</span>
<span class="co">#&gt; 2 Dimension 1   y2  0.70 0.1262953 0.08840671 0.2839217</span>
<span class="co">#&gt; 3 Dimension 1   y3  0.53 0.2248045 0.11914640 0.3826434</span>
<span class="co">#&gt; 4       Total &lt;NA&gt;    NA 1.0000000 0.31137714 1.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_scores</span>
<span class="co">#&gt;   N_Obs.      Mean Std._Dev. Min Max</span>
<span class="co">#&gt; 1    100 0.3113771 0.2907748   0   1</span></code></pre></div>
<p>For a simple overview or for further processing with a narrow objective, specifying one or at most very few output-elements should suffice. When doing elaborated analysis it is most likely convenient to specify the <code>output</code> as <code>"all"</code> and to save the <code>mdepriv</code>-return which in this case is a <code>list</code>. Next the user can pick specific elements from the <code>list</code> in several ways:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdepriv_returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="co"># 3 ways to pick an element as such from list</span>
<span class="va">mdepriv_returns</span><span class="op">$</span><span class="va">weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="va">mdepriv_returns</span><span class="op">[[</span><span class="st">"weighting_scheme"</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="va">mdepriv_returns</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># by index; also works with unnamed lists</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span></code></pre></div>
<p>Warning: Don’t confuse a <code>list</code> of only 1 element with the very element as such:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdepriv_returns</span><span class="op">[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span> <span class="co"># a list with only 1 element ...</span>
<span class="co">#&gt; $aggregate_deprivation_level</span>
<span class="co">#&gt; [1] 0.3719576</span>
<span class="va">mdepriv_returns</span><span class="op">[[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span><span class="op">]</span> <span class="co"># ... and the very element as such ...</span>
<span class="co">#&gt; [1] 0.3719576</span>
<span class="co"># ... might look somewhat the same</span>
<span class="va">mdepriv_returns</span><span class="op">[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span> <span class="op">==</span> <span class="va">mdepriv_returns</span><span class="op">[[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; aggregate_deprivation_level </span>
<span class="co">#&gt;                        TRUE</span>
<span class="co"># but ... they are not</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mdepriv_returns</span><span class="op">[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Error in round(mdepriv_returns["aggregate_deprivation_level"], 2): Nicht-numerisches Argument für mathematische Funktion</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mdepriv_returns</span><span class="op">[[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.37</span>

<span class="co"># if unsure about what you are dealing with: check!</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mdepriv_returns</span><span class="op">[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mdepriv_returns</span><span class="op">[[</span><span class="st">"aggregate_deprivation_level"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "numeric"</span></code></pre></div>
<p>Working with the returns from multiple <code>mdepriv</code> models saved as a separate <code>list</code>s can become cumbersome. However, there is a convenient alternative. One can combine the returned <code>list</code>s in a <code>data.frame</code> where every model is a row and the different <code>output</code> elements are gathered as columns/variables (s. <a href="#multiple-models-in-a-data.frame">Multiple Models in a data.frame</a>).</p>
</div>
<div id="grouping-items-as-dimensions" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping-items-as-dimensions" class="anchor"></a>Grouping Items as Dimensions</h2>
<p>The user may group items in separate dimensions. Each dimension is allocated a weight sum of <span class="math inline">\(\frac{1}{K}\)</span>, K being the number of dimensions in the model. The item weights are calculated separately for each dimension; they too sum to <span class="math inline">\(\frac{1}{K}\)</span> for each dimension, thus keeping the sum total of weights = 1. The sum of item contributions (<code>Contri</code>) per dimension is reflected as dimension-wise contribution in the <code>summary_by_dimension</code>. The dimension indices are “backward-engineered”, i.e. = <span class="math inline">\(\frac{contribution}{weight}\)</span>. The deprivation scores, however, are computed in a unified way for the entire model, not for every dimension. If the user requires dimension-wise scores, then these must come from separate models.</p>
<p>Grouping items / indicators by dimensions is appropriate when there are substantive or policy reasons to keep their weights independent and their weight sums identical across dimensions. This is the case when redundancy should be controlled for among items within each group, but not between items of different groups. There may be institutional considerations, e.g., when some items may be highly correlated between groups, but the importance (weight sum) of the groups should be kept equal. For example, water deprivation and sanitation deprivation are correlated, but the humanitarian sub-sectors looking into them may need to participate in the severity calculation with equal weight.</p>
<p>Items are grouped in dimensions by placing them in vectors that are elements of a <code>list</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $aggregate_deprivation_level</span>
<span class="co">#&gt; [1] 0.4128214</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_dimension</span>
<span class="co">#&gt;     Dimension N_Item     Index Weight    Contri     Share</span>
<span class="co">#&gt; 1 Dimension 1      3 0.2583537    0.5 0.1291769 0.3129122</span>
<span class="co">#&gt; 2 Dimension 2      2 0.5672892    0.5 0.2836446 0.6870878</span>
<span class="co">#&gt; 3       Total      5        NA    1.0 0.4128214 1.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_item</span>
<span class="co">#&gt;     Dimension Item   Index     Weight     Contri      Share</span>
<span class="co">#&gt; 1 Dimension 1   y1 0.16000 0.26355861 0.04216938 0.10214920</span>
<span class="co">#&gt; 2 Dimension 1   y2 0.70000 0.05129636 0.03590745 0.08698058</span>
<span class="co">#&gt; 3 Dimension 1   y4 0.27600 0.18514503 0.05110003 0.12378240</span>
<span class="co">#&gt; 4 Dimension 2   y5 0.69579 0.17177312 0.11951802 0.28951505</span>
<span class="co">#&gt; 5 Dimension 2   y6 0.50004 0.32822688 0.16412657 0.39757278</span>
<span class="co">#&gt; 6       Total &lt;NA&gt;      NA 1.00000000 0.41282144 1.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_scores</span>
<span class="co">#&gt;   N_Obs.      Mean Std._Dev.       Min       Max</span>
<span class="co">#&gt; 1    100 0.4128214  0.190703 0.1204958 0.9402168</span></code></pre></div>
<p>If not happy with the default labelling of dimensions, the user can customize it:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Group A'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span><span class="op">)</span>, <span class="st">'Group B'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"summary_by_dimension"</span>, <span class="st">"summary_by_item"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $summary_by_dimension</span>
<span class="co">#&gt;   Dimension N_Item     Index Weight    Contri     Share</span>
<span class="co">#&gt; 1   Group A      3 0.2583537    0.5 0.1291769 0.3129122</span>
<span class="co">#&gt; 2   Group B      2 0.5672892    0.5 0.2836446 0.6870878</span>
<span class="co">#&gt; 3     Total      5        NA    1.0 0.4128214 1.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_item</span>
<span class="co">#&gt;   Dimension Item   Index     Weight     Contri      Share</span>
<span class="co">#&gt; 1   Group A   y1 0.16000 0.26355861 0.04216938 0.10214920</span>
<span class="co">#&gt; 2   Group A   y2 0.70000 0.05129636 0.03590745 0.08698058</span>
<span class="co">#&gt; 3   Group A   y4 0.27600 0.18514503 0.05110003 0.12378240</span>
<span class="co">#&gt; 4   Group B   y5 0.69579 0.17177312 0.11951802 0.28951505</span>
<span class="co">#&gt; 5   Group B   y6 0.50004 0.32822688 0.16412657 0.39757278</span>
<span class="co">#&gt; 6     Total &lt;NA&gt;      NA 1.00000000 0.41282144 1.00000000</span></code></pre></div>
<p><a name="reuse_itmes"></a> The set of <code>items</code> can be taken from one model and passed on to another:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Group A'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span><span class="op">)</span>, <span class="st">'Group B'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span>,
              method <span class="op">=</span> <span class="st">"ds"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">bv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">ds</span><span class="op">$</span><span class="va">items</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">items</span>, <span class="va">bv</span><span class="op">$</span><span class="va">items</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>The <code>output</code> element <code>items</code> is always returned as a <code>list</code>. This is true also when <code>items</code> were passed as a simple vector of characters strings, with no dimensions specified. The returned <code>items</code> remain a recyclable argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span><span class="op">)</span><span class="op">)</span> <span class="co"># items in character vector</span>
<span class="co">#&gt; [1] "character"</span>
<span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">model_1</span><span class="op">$</span><span class="va">items</span> <span class="co"># same items are returned in a list with one dimension</span>
<span class="co">#&gt; $`Dimension 1`</span>
<span class="co">#&gt; [1] "y1" "y2" "y4"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">$</span><span class="va">items</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">model_1</span><span class="op">$</span><span class="va">items</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">model_1</span>, <span class="va">model_2</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co"># whether a 'one dimensional list' or a simple vector does not matter.</span></code></pre></div>
</div>
<div id="sampling-weights" class="section level2">
<h2 class="hasAnchor">
<a href="#sampling-weights" class="anchor"></a>Sampling Weights</h2>
<p><code>mdepriv</code>’s third argument <code>sampling_weights</code> is optional. Its specification targets a numeric variable within the argument <code>data</code> by the character string corresponding to the very column heading. Integers as well as non-integers are admitted as sampling weights. By default the argument <code>sampling_weights</code> is set to NA, which means unspecified.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># see what's included in the input data</span>
<span class="co">#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights</span>
<span class="co">#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556</span>
<span class="co">#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500</span>
<span class="co">#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973</span>

<span class="co"># if sampling_weights are specified the very specification </span>
<span class="co"># and the sum of sampling weights are available as returns ...</span>
<span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, <span class="st">"sampl_weights"</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sampling_weights"</span>, <span class="st">"sum_sampling_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $sum_sampling_weights</span>
<span class="co">#&gt; [1] 100.237</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sampling_weights</span>
<span class="co">#&gt; [1] "sampl_weights"</span>

<span class="co"># ... if unspecified, the outcome consequently is:</span>
<span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sampling_weights"</span>, <span class="st">"sum_sampling_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $sum_sampling_weights</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sampling_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
</div>
<div id="standard-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-methods" class="anchor"></a>Standard Methods</h2>
<p>Four different standard <code>method</code>s for calculating synthetic scores of multiple deprivations are available:</p>
<ul>
<li>
<code>"cz"</code>:     Cerioli &amp; Zani (1990) weighting</li>
<li>
<code>"ds"</code>:     Desai &amp; Shah (1988) weighting</li>
<li>
<code>"bv"</code>:     Betti &amp; Verma (1998) weighting</li>
<li>
<code>"equal"</code>:   Equi-proportionate weighting</li>
</ul>
<p>We compare aggregated deprivation levels by <code>method</code> and by the use of the sampling weights or not.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cz"</span>, <span class="st">"ds"</span>, <span class="st">"bv"</span>, <span class="st">"equal"</span><span class="op">)</span> <span class="co"># all available methods</span>
<span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>

<span class="co"># aggregate deprivation levels when no sampling weights are applied</span>
<span class="op">(</span><span class="va">without_s_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="va">x</span>, output <span class="op">=</span> <span class="st">"aggregate_deprivation_level"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        cz        ds        bv     equal </span>
<span class="co">#&gt; 0.3719576 0.4135734 0.4321696 0.4801443</span>

<span class="co"># aggregate deprivation levels when sampling weights are applied</span>
<span class="op">(</span><span class="va">with_s_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, <span class="st">"sampl_weights"</span>, method <span class="op">=</span> <span class="va">x</span>, output <span class="op">=</span> <span class="st">"aggregate_deprivation_level"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        cz        ds        bv     equal </span>
<span class="co">#&gt; 0.3658611 0.4111543 0.4271009 0.4807106</span>

<span class="co"># channel the figures to a plot</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">without_s_w</span>, <span class="va">with_s_w</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sampling_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">sampling_weight</span>, names_to <span class="op">=</span> <span class="st">"method"</span>, values_to <span class="op">=</span> <span class="st">"aggregate_deprivation_level"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>method <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># methods as factor ordered by first appearance (-&gt; sequence in plot)</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">method</span>, y <span class="op">=</span> <span class="va">aggregate_deprivation_level</span>, fill <span class="op">=</span> <span class="va">sampling_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"aggregate deprivation level, by method"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig1-1.png" width="528"></p>
<p>Lets investigate the differences of the <code>method</code>s, not only based on the single figure <code>aggregate_deprivation_level</code>, but also on a comparison of <code>summary_by_item</code>-tables.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>
<span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cz"</span>, <span class="st">"ds"</span>, <span class="st">"bv"</span>, <span class="st">"equal"</span><span class="op">)</span> <span class="co"># all available methods</span>
<span class="va">sampling_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sampl_weights"</span>, <span class="cn">NA</span><span class="op">)</span> <span class="co"># sampling weights specified/unspecified</span>

<span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">methods</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sampling_weights</span><span class="op">)</span><span class="op">)</span>
<span class="co"># repeat methods as many times as there are different (non-)specifications of sampling weights</span>
<span class="va">sampling_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">sampling_weights</span>, each <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">methods</span><span class="op">)</span><span class="op">)</span>
<span class="co"># repeat each different sampling-weights (non-)specifications as many times as there are distinct methods</span>

<span class="co"># aggregate summary_by_item-tables and channel them to a plot</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">methods</span><span class="op">)</span>,
  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span>
      <span class="va">simul_data</span>,
      <span class="va">items_sel</span>,
      sampling_weights <span class="op">=</span> <span class="va">sampling_weights</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
      method <span class="op">=</span> <span class="va">methods</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
      output <span class="op">=</span> <span class="st">"summary_by_item"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="op">(</span><span class="va">.</span>, <span class="co"># 'listed' summary_by_item-tables as variable</span>
    method <span class="op">=</span> <span class="va">methods</span>, <span class="co"># methods as variable</span>
    sampling_weight <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sampling_weights</span><span class="op">)</span> <span class="co"># TRUE if sampl. weights applied else FALSE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">unnest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">!=</span> <span class="st">"Total"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="co"># filter out rows with the totals inherited from the summary_by_item-tables</span>
    <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sampling_weight</span>, <span class="va">method</span>, <span class="va">Item</span><span class="op">)</span>, <span class="st">"key"</span>, <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>key <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">key</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="co"># key &amp; method as factors ordered by first appearance </span>
    <span class="co"># -&gt; non-alphabetical sequences in plot grid (key as rows, method as columns)</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Item</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">sampling_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">facet_grid</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">key</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">method</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"method vs. key figures from the summary by item"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig2-1.png" width="696"></p>
<p><a name="method_default_settings"></a> Different <code>method</code>s do matter as far as their results, but this should not be confused with the default argument settings of <code>mdepriv</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The Cerioli &amp; Zani (1990) weighting scheme is the default method and must not really be specified</span>
<span class="va">cz_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span><span class="op">)</span>
<span class="va">cz_explicit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"cz"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">cz_default</span>, <span class="va">cz_explicit</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="co"># The Betti &amp; Verma (1998) weighting scheme has to be chosen explicitly, ...</span>
<span class="va">bv_standard_lazy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bv"</span><span class="op">)</span>
<span class="co"># ... it is associated with two further arguments with default settings.</span>
<span class="va">bv_standard_explicit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bv"</span>,
                                bv_corr_type <span class="op">=</span> <span class="st">"mixed"</span>, rhoH <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">bv_standard_lazy</span>, <span class="va">bv_standard_explicit</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="specification-of-the-betti-verma-double-weighting" class="section level2">
<h2 class="hasAnchor">
<a href="#specification-of-the-betti-verma-double-weighting" class="anchor"></a>Specification of the Betti-Verma Double Weighting</h2>
<p>As seen <a href="#method_default_settings">above</a>, the Betti &amp; Verma’s (1998) double-weighting <code>method</code> <code>"bv"</code> comes with default settings for the associated arguments <code>bv_corr_type</code> and <code>rhoH</code>. These arguments affect the second factor (<code>wb</code>) of the double-weighting and thus the overall outcome if <code>"bv"</code> is chosen as method.</p>
<p><a name="mixed_rule"></a> <code>bv_corr_type</code>’s default setting <code>"mixed"</code> detects automatically the appropriate correlation type for each pair of items by the following rules:</p>
<ul>
<li>
<code>"pearson"</code>: both items have &gt; 10 distinct values.</li>
<li>
<code>"polyserial"</code>: one item has <span class="math inline">\(\le\)</span> 10, the other &gt; 10 distinct values.</li>
<li>
<code>"polychoric"</code>: both items have <span class="math inline">\(\le\)</span> 10 distinct values.</li>
</ul>
<p>By choosing <code>"pearson"</code> as <code>bv_corr_type</code> this correlation type is forced on all combinations of items. Situations that would motivate <code>"pearson"</code> as a choice are rare and far-fetched. When ordinal indicators are present, and they are transformed to interval- or ratio-level variables (e.g., as ridits), forcing <code>"pearson"</code>-type correlations may make for more consistent redundancy reductions for all indicators.</p>
<p>The <code>"mixed"</code> correlation-type default is not only convenient, but also appropriate for most indicator constellations. One may want to know the type that <code>"mixed"</code> selects for a given pair of items. The function <code>corr_mat</code>, besides calculating the coefficients, can also reveal the involved correlation types. <code>corr_mat</code>’s first three arguments are the same as those of <code>mdepriv</code>. The options of the fourth argument <code>corr_type</code> are analogue to those of the <code>mdepriv</code>’s argument <code>bv_corr_type</code>, where <code>"mixed"</code> is also the default setting.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">very_explicit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corr_mat.html">corr_mat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simul_data</span>, items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span>, 
                          sampling_weights <span class="op">=</span> <span class="st">"sampl_weights"</span>, corr_type <span class="op">=</span> <span class="st">"mixed"</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>
<span class="va">rather_minimalistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corr_mat.html">corr_mat</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y4"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span>, <span class="st">"sampl_weights"</span>, output <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">very_explicit</span>, <span class="va">rather_minimalistic</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="va">rather_minimalistic</span>
<span class="co">#&gt; $numeric</span>
<span class="co">#&gt;           y1         y4           y6           y7</span>
<span class="co">#&gt; y1 1.0000000 0.79871297  0.370557815  0.139874614</span>
<span class="co">#&gt; y4 0.7987130 1.00000000  0.040235317  0.062735666</span>
<span class="co">#&gt; y6 0.3705578 0.04023532  1.000000000 -0.007169907</span>
<span class="co">#&gt; y7 0.1398746 0.06273567 -0.007169907  1.000000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt;    y1           y4           y6           y7          </span>
<span class="co">#&gt; y1 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="co">#&gt; y4 "polychoric" "polychoric" "polyserial" "polyserial"</span>
<span class="co">#&gt; y6 "polyserial" "polyserial" "pearson"    "pearson"   </span>
<span class="co">#&gt; y7 "polyserial" "polyserial" "pearson"    "pearson"</span></code></pre></div>
<p>Note that <code>corr_mat</code>’s <code>output</code> is set by default to <code>"numeric"</code>. If desired <code>"type"</code> or <code>"both"</code> have to be specified.</p>
<p><code>mdepriv</code>’s argument <code>rhoH</code> distributes high and low coefficients of the triangular item correlation table to two factors. By default <code>rhoH</code> is set to NA, which causes its automatic calculation according to Betti &amp; Verma’s (1998) suggestion to divide the ordered set of correlation coefficients at the point of their largest gap (excluding the diagonal elements).</p>
<p><img src="mdepriv_get_started_files/figure-html/Fig3-1.png" width="680.314960629921"></p>
<p>Alternatively, the user can set a fixed value for <code>rhoH</code> in the interval [-1, +1]. When <code>rhoH</code> is automatically calculated, the weights of items that overall are more weakly correlated with the other items turn out higher, compared to their weights when the user chooses a <code>rhoH</code> value far from the automatic version. Setting <code>rhoH</code> to -1 or +1 (the bounds of its range) causes all correlation coefficients to be assigned to one set only. However, in our experiments the item weight differences between models with automatically calculated vs. user-defined <code>rhoH</code> have been modest, rarely more than 10 percent up or down. Both variants - data-driven or user-defined - of <code>rhoH</code>, in combination with the chosen <code>bv_coor_type</code>, affect the outcome of the Betty-Verma double weighting model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>
<span class="va">rhoHs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="co"># fixed rhoHs &amp; NA (= default specification for data driven rhoH)</span>
<span class="va">bv_corr_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mixed"</span>, <span class="st">"pearson"</span><span class="op">)</span> <span class="co"># correlation types</span>

<span class="va">rhoHs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">rhoHs</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">bv_corr_types</span><span class="op">)</span><span class="op">)</span>
<span class="co"># repeat rhoHs as many times as there are different correlation types</span>
<span class="va">bv_corr_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">bv_corr_types</span>, each <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">rhoHs</span><span class="op">)</span><span class="op">)</span>
<span class="co"># repeat each different correlation type as many times as there are distinct values of rhoH</span>

<span class="va">rhoH_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">rhoHs</span><span class="op">)</span>, <span class="st">"data driven"</span>, <span class="st">"fixed"</span><span class="op">)</span> <span class="co"># rhoH type / classification</span>
<span class="va">rhoH_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">rhoH_type</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"data driven"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># factorize for non-alphabetical sequence in plot</span>

<span class="co"># get and plot the (under the hood) applied rhoHs and aggregate_deprivation_level</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">rhoHs</span><span class="op">)</span>,
  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span>
      <span class="va">simul_data</span>,
      <span class="va">items_sel</span>,
      method <span class="op">=</span> <span class="st">"bv"</span>,
      bv_corr_type <span class="op">=</span> <span class="va">bv_corr_types</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
      rhoH <span class="op">=</span> <span class="va">rhoHs</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,
      output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"aggregate_deprivation_level"</span>, <span class="st">"rhoH"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>
      bv_corr_type <span class="op">=</span> <span class="va">bv_corr_types</span>,
      rhoH_type <span class="op">=</span> <span class="va">rhoH_type</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rhoH</span>,
      y <span class="op">=</span> <span class="va">aggregate_deprivation_level</span>,
      col <span class="op">=</span> <span class="va">bv_corr_type</span>,
      shape <span class="op">=</span> <span class="va">rhoH_type</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"aggregate deprivation level vs. fixed and data driven rhoH"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig4-1.png" width="680.314960629921"></p>
<p>As far as this model with simulated data is representative of the behavior of <code>rhoH</code>, it would appear that the maximum aggregate deprivation level is at or near the one obtained when <code>rhoH</code> is entirely data-driven.</p>
<p>Setting a fixed value for <code>rhoH</code> by the user is rarely called for, except when a constant <code>rhoH</code> is required for the comparison of several <a href="#wa_wb_comination">models with double-weighting</a>.</p>
<p>As a technicality, it may be noted that, if the user chooses more than one dimension, <code>rhoH</code> is common for all. If this is the case and <code>rhoH</code> is data-driven, <code>rhoH</code> might not equal the correlation coefficient between any of the items pairs within the dimensions. Instead the correlation coefficient at the upper bound of the greatest gap may be between two items that belong to different dimensions. This definition is necessary in order to avoid the breakdown of the Betti-Verma formula in models in which some dimension(s) has/have only one element. The technicality is of no practical consequence for the user.</p>
</div>
<div id="flexible-double-weighting-schemes-beyond-betti-verma" class="section level2">
<h2 class="hasAnchor">
<a href="#flexible-double-weighting-schemes-beyond-betti-verma" class="anchor"></a>Flexible Double Weighting Schemes beyond Betti-Verma</h2>
<p>Although historically Betti and Verma devised double-weighting for the method named after them, <code>mdepriv</code> makes it available in the other methods as well. That is, additionally to the <a href="#standard-methods">standard <code>method</code>s</a> the arguments <code>wa</code> and <code>wb</code> provide alternative, more flexible ways to select the weighting schemes. Weights are computed as the product of two terms as in the Betti-Verma scheme. <code>wa</code> selects the form of the first factor and is one of <code>"cz"</code>, <code>"ds"</code>, <code>"bv"</code> or <code>"equal"</code>. <code>wb</code> selects the form of the second factor and is one of <code>"mixed"</code>, <code>"pearson"</code> or <code>"diagonal"</code>, where the latter sets all off-diagonal correlations to zero. Any true double-weighting scheme involves <code>rhoH</code> as does the <a href="#specification-of-the-betti-verma-double-weighting">Betti-Verma method</a>, either as data-driven (the default) or fixed by specification.</p>
<p><a name="wa_wb_comination"></a> <img src="mdepriv_get_started_files/figure-html/Fig5-1.png" width="680.314960629921"></p>
<p>Thus applying <code>"diagonal"</code> to <code>wb</code> and specifying <code>wa</code> as <code>"cz"</code>, <code>"ds"</code> or <code>"equal"</code> basically delivers the same result as when choosing the corresponding named <code>method</code>. Only the first <code>output</code> element differs:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ds"</span><span class="op">)</span>
<span class="va">ds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Desai &amp; Shah (1988) weighting scheme"</span>
<span class="va">ds_diagonal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, wa <span class="op">=</span> <span class="st">"ds"</span>, wb <span class="op">=</span> <span class="st">"diagonal"</span><span class="op">)</span>
<span class="va">ds_diagonal</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "User-defined weighting scheme: wa = \"ds\", wb = \"diagonal\"."</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">ds</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ds_diagonal</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Betti &amp; Verma (1998) weighting schemes also have lookalikes among the <code>wa</code>-<code>wb</code>-combinations:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bv"</span>, bv_corr_type <span class="op">=</span> <span class="st">"pearson"</span>, rhoH <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="va">bv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Betti &amp; Verma (1998) weighting scheme"</span>
<span class="va">bv_pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, wa <span class="op">=</span> <span class="st">"bv"</span>, wb <span class="op">=</span> <span class="st">"pearson"</span>, rhoH <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="va">bv_pearson</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "User-defined weighting scheme: wa = \"bv\", wb = \"pearson\"."</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">bv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bv_pearson</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>So lets have a look at the items weights of some non-standard <code>wa</code>-<code>wb</code>-weighting schemes:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>

<span class="co"># wa-wb-combinations</span>
<span class="va">wa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cz"</span>, <span class="st">"ds"</span>, <span class="st">"equal"</span>, <span class="st">"bv"</span><span class="op">)</span>
<span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"mixed"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"diagonal"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">wa</span>, <span class="va">wb</span><span class="op">)</span>
<span class="co">#&gt;      wa       wb</span>
<span class="co">#&gt; 1    cz    mixed</span>
<span class="co">#&gt; 2    ds    mixed</span>
<span class="co">#&gt; 3 equal    mixed</span>
<span class="co">#&gt; 4    bv diagonal</span>

<span class="co"># list with summaries by items for each wa-wb-combination</span>
<span class="va">summary_by_item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">wa</span><span class="op">)</span>,
  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, wa <span class="op">=</span> <span class="va">wa</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, wb <span class="op">=</span> <span class="va">wb</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, output <span class="op">=</span> <span class="st">"summary_by_item"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># channel figures to a plot</span>
<span class="fu">tibble</span><span class="op">(</span> <span class="co"># gather varied arguments &amp; outputs in a tibble / data.frame</span>
  wa <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">wa</span><span class="op">)</span>, <span class="co"># order arguments ...</span>
  wb <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">wb</span><span class="op">)</span>, <span class="co"># ... by first appearance</span>
  <span class="va">summary_by_item</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Item</span> <span class="op">!=</span> <span class="st">"Total"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># filter out rows with the totals inherited from the summary_by_item-tables</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Item</span>, y <span class="op">=</span> <span class="va">Weight</span>, fill <span class="op">=</span> <span class="va">Item</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">wa</span>, <span class="va">wb</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Item Weights from User Defined Double Weighting Schemes"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig6-1.png" width="680.314960629921"></p>
<p>The largest differences in weights are between the <code>"bv"</code>-<code>"diagonal"</code> model vs. the three others, for all of which <code>wb</code> as set to <code>"mixed"</code>. In the former, the correlations among items have no effect on the weights because of <code>wb</code> = <code>"diagonal"</code>. In the latter, they take full effect, due to <code>wb</code> = "<code>mixed"</code>. Note that for each of the seven items, the Desai-Shaw weight is in the interval defined by the respective Cerioli-Zani and equi-proportionate weights. This is so because Desai-Shaw’s sensitivity to the means of items is less than that of Cerioli-Zani; it is higher than in the equi-proportionate method, which is indifferent to the item means. <a href="#reason_wa_wb">The remarks and table above</a> give reasons for selecting particular wa-wb-combinations in reference to analytic objectives.</p>
</div>
<div id="expertise-based-weights-for-items" class="section level2">
<h2 class="hasAnchor">
<a href="#expertise-based-weights-for-items" class="anchor"></a>Expertise-Based Weights for Items</h2>
<p>Instead of a data-driven weighting scheme users can pass expertise-based weights to items. This is done by structuring the argument <code>user_def_weights</code> analogously to the <code>items</code>’ argument. For each of the <a href="#grouping-items-as-dimensions">dimensions</a> (= group of items) the user-defined weights must sum up to 1. When returned as an output <code>user_def_weights</code> inherits the dimensions’ labelling specified by the <code>items</code>’ argument.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>,
  items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Group A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>, <span class="st">"Group B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y5"</span>, <span class="st">"y6"</span><span class="op">)</span><span class="op">)</span>,
  user_def_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.35</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,
  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"weighting_scheme"</span>,
    <span class="st">"summary_by_dimension"</span>,
    <span class="st">"summary_by_item"</span>,
    <span class="st">"items"</span>,
    <span class="st">"user_def_weights"</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Item-wise user-defined weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_dimension</span>
<span class="co">#&gt;   Dimension N_Item   Index Weight  Contri     Share</span>
<span class="co">#&gt; 1   Group A      2 0.34900    0.5 0.17450 0.3470427</span>
<span class="co">#&gt; 2   Group B      2 0.65664    0.5 0.32832 0.6529573</span>
<span class="co">#&gt; 3     Total      4      NA    1.0 0.50282 1.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summary_by_item</span>
<span class="co">#&gt;   Dimension Item   Index Weight   Contri      Share</span>
<span class="co">#&gt; 1   Group A   y1 0.16000  0.325 0.052000 0.10341673</span>
<span class="co">#&gt; 2   Group A   y2 0.70000  0.175 0.122500 0.24362595</span>
<span class="co">#&gt; 3   Group B   y5 0.69579  0.400 0.278316 0.55351020</span>
<span class="co">#&gt; 4   Group B   y6 0.50004  0.100 0.050004 0.09944712</span>
<span class="co">#&gt; 5     Total &lt;NA&gt;      NA  1.000 0.502820 1.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $items</span>
<span class="co">#&gt; $items$`Group A`</span>
<span class="co">#&gt; [1] "y1" "y2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $items$`Group B`</span>
<span class="co">#&gt; [1] "y5" "y6"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; $user_def_weights$`Group A`</span>
<span class="co">#&gt; [1] 0.65 0.35</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights$`Group B`</span>
<span class="co">#&gt; [1] 0.8 0.2</span></code></pre></div>
</div>
<div id="check-the-weighting-scheme" class="section level2">
<h2 class="hasAnchor">
<a href="#check-the-weighting-scheme" class="anchor"></a>Check the Weighting Scheme</h2>
<p>The <code>mdepriv</code> arguments <code>method</code>, <code>bv_corr_type</code>, <code>wa</code>, <code>wb</code>, <code>rhoH</code> and/or <code>user_def_weights</code> set the weighting scheme. <code>method</code>, <code>bv_corr_type</code> and <code>rhoH</code> have default values. Any setting of <code>bv_corr_type</code> is bypassed if <code>method</code> is not <code>"bv"</code> and both <code>wa</code> and <code>wb</code> are unspecified. Any <code>rhoH</code> setting is bypassed if an <a href="#wa_wb_comination">effective single weighting scheme</a> is applied. If <code>user_def_weights</code> is specified, the arguments <code>method</code>, <code>bv_corr_type</code>, <code>wa</code>, <code>wb</code> and <code>rhoH</code> do not matter. If that is confusing, the <code>output</code> elements <code>"weighting_scheme"</code>, <code>"wa"</code>, <code>"wb"</code>, <code>"rhoH"</code> and <code>"user_def_weights"</code> can always be relied upon to tell the specifics of the weighting scheme effectively applied.</p>
<p>What’s going on under the hood if …</p>
<p>… no <code>method</code> is specified?</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "cz"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "diagonal"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… <code>bv</code> as <code>method</code> and else nothing with relevance for the weighing scheme is specified?</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,  method <span class="op">=</span> <span class="st">"bv"</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Betti &amp; Verma (1998) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "bv"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "mixed"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] 0.3472574</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… <code>bv</code> as <code>method</code> + the associated <code>bv_corr_type</code> and <code>rhoH</code> are specified?</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,  method <span class="op">=</span> <span class="st">"bv"</span>, bv_corr_type <span class="op">=</span> <span class="st">"pearson"</span>, rhoH <span class="op">=</span> <span class="fl">0.3</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Betti &amp; Verma (1998) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "bv"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "pearson"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… an effective single weighting <code>method</code> + meaningless <code>bv_corr_type</code> and <code>rhoH</code> are specified?</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,  method <span class="op">=</span> <span class="st">"ds"</span>, bv_corr_type <span class="op">=</span> <span class="st">"pearson"</span>, rhoH <span class="op">=</span> <span class="fl">0.3</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Desai &amp; Shah (1988) weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "ds"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "diagonal"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… user defined effective single weighting scheme and some meaningless <code>rhoH</code> specification are applied?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,  wa <span class="op">=</span> <span class="st">"bv"</span>, wb <span class="op">=</span> <span class="st">"diagonal"</span>, rhoH <span class="op">=</span> <span class="fl">0.7</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "User-defined weighting scheme: wa = \"bv\", wb = \"diagonal\"."</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "bv"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "diagonal"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… user defined double weighting scheme with + <code>rhoH</code> specification kick in?</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>,  wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>, rhoH <span class="op">=</span> <span class="fl">0.5</span>,
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "User-defined weighting scheme: wa = \"equal\", wb = \"mixed\"."</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] "equal"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] "mixed"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>… expertise-base weighting scheme and an ignored <code>method</code> are applied?</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"cz"</span>,
        user_def_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.55</span><span class="op">)</span><span class="op">)</span>, 
        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"weighting_scheme"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"user_def_weights"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $weighting_scheme</span>
<span class="co">#&gt; [1] "Item-wise user-defined weighting scheme"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wa</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $wb</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rhoH</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights</span>
<span class="co">#&gt; $user_def_weights$`Dimension 1`</span>
<span class="co">#&gt; [1] 0.3 0.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $user_def_weights$`Dimension 2`</span>
<span class="co">#&gt; [1] 0.45 0.55</span></code></pre></div>
<p><a name="re_use_weighting_scheme"></a> <a href="#check-the-weighting-scheme">As shown above</a> the <code>output</code> elements <code>"weighting_scheme"</code>, <code>"wa"</code>, <code>"wb"</code>, <code>"rhoH"</code> and <code>"user_def_weights"</code> tell reliably the specifics of the weighting scheme effectively applied. With the exception of <code>"weighting_scheme"</code>, those <code>output</code> elements can be re-used as specifications for homonymous arguments in another model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">wa</span>
<span class="co">#&gt; [1] "cz"</span>
<span class="va">model</span><span class="op">$</span><span class="va">wb</span>
<span class="co">#&gt; [1] "diagonal"</span>
<span class="va">other_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, wa <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">wa</span>, wb <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">wb</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">other_model</span><span class="op">)</span> <span class="co"># is there a difference? ...</span>
<span class="co">#&gt; [1] "Component \"weighting_scheme\": 1 string mismatch"</span>
<span class="co"># ... expect for weighting_scheme all outputs are the same</span>
<span class="va">model</span><span class="op">$</span><span class="va">weighting_scheme</span>
<span class="co">#&gt; [1] "Cerioli &amp; Zani (1990) weighting scheme"</span>
<span class="va">other_model</span><span class="op">$</span><span class="va">weighting_scheme</span>
<span class="co">#&gt; [1] "User-defined weighting scheme: wa = \"cz\", wb = \"diagonal\"."</span></code></pre></div>
<p><code>"wa"</code> can be applied also to the argument <code>method</code> of another model:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">other_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">wa</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">other_model</span><span class="op">)</span> <span class="co"># no difference</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Whereas <code>"wb"</code> can be applied only to the argument <code>bv_corr_type</code>, and only if it is not <code>"diagonal"</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bv"</span>, bv_corr_type <span class="op">=</span> <span class="st">"pearson"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">other_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span><span class="op">)</span>, method <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">wa</span>, bv_corr_type <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">wb</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">other_model</span><span class="op">)</span> <span class="co"># no difference</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Note that situations where recycling of <code>outputs</code> as specifications for setting weighting schemes make sense are rare. This is the case if a certain weighting scheme should be run on different datasets or different selections of items. Except for data driven <code>rhoH</code>s and specified <code>user_def_weights</code>, which are cumbersome to re-type (with every digit) there is not much practical use for doing so.</p>
</div>
<div id="obtaining-the-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#obtaining-the-scores" class="anchor"></a>Obtaining the Scores</h2>
<p>The scores are the individual deprivation values, calculated as the vector products of the individual item values and the weights returned by <code>mdepriv</code>.</p>
<p>The score summary is obtained via the <code>output</code> option <code>"summary_scores"</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>
<span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"ds"</span>, output <span class="op">=</span> <span class="st">"summary_scores"</span><span class="op">)</span>
<span class="co">#&gt;   N_Obs.      Mean Std._Dev.        Min       Max</span>
<span class="co">#&gt; 1    100 0.4135734 0.1982925 0.08118954 0.9443571</span></code></pre></div>
<p>The <code>output</code> option <code>"score_i"</code> provides direct access to the vector of scores for their immediate further use:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>

<span class="va">bv_diagonal_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, <span class="st">"sampl_weights"</span>,
                              wa <span class="op">=</span> <span class="st">"bv"</span>, wb <span class="op">=</span> <span class="st">"diagonal"</span>, output <span class="op">=</span> <span class="st">"score_i"</span><span class="op">)</span>
<span class="va">eq_mixed_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, <span class="st">"sampl_weights"</span>,
                           wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>, output <span class="op">=</span> <span class="st">"score_i"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">bv_diagonal_scores</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"scores: wa: bv &amp; wb: diagonal"</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">eq_mixed_scores</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"scores: wa = equal &amp; wb = mixed"</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bv_diagonal_scores</span>, <span class="va">eq_mixed_scores</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="st">"scores: wa: bv &amp; wb: diagonal"</span>,
  ylab <span class="op">=</span> <span class="st">"scores: wa: equal &amp; wb: mixed"</span>,
  main <span class="op">=</span> <span class="st">"scores: bv/diagonal vs. equal/mixed"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig7-1.png" width="864"></p>
<p>These scores are also merged to the <code>output</code> element <code>"data"</code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># default heading of score column</span>
<span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, output <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights    score_i</span>
<span class="co">#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556 0.06663388</span>
<span class="co">#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500 0.72888025</span>
<span class="co">#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973 0.49115525</span>

<span class="co"># user-defined heading of score column</span>
<span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, score_i_heading <span class="op">=</span> <span class="st">"score_i_user_name"</span>, output <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights score_i_user_name</span>
<span class="co">#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556        0.06663388</span>
<span class="co">#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500        0.72888025</span>
<span class="co">#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973        0.49115525</span></code></pre></div>
<p><a name="reuse_data"></a> Thus the scores are accessible in two ways:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="co"># method (default) = "cz"</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">score_i</span>, <span class="va">model</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">score_i</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>The score column heading impacts the ability of the <code>output</code> element <code>"data"</code> being used as input <code>data</code> in another model:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"ds"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="co">#&gt; Error: "score_i" is not valid as argument 'score_i_heading' for the current model. For the argument 'data' already includes a column by this name, possibly as the result of a previous mdepriv model. Therefore, give a different name for the scores column in the output data by specifying the argument 'score_i_heading'.</span></code></pre></div>
<p>Note: <code>"score_i"</code> is the default setting of the argument <code>score_i_heading</code>. By distinguishing the score columns using the argument <code>score_i_heading</code> in a cascade of models, the <code>output</code> element <code>"data"</code> can be re-used multiple times.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"ds"</span>, score_i_heading <span class="op">=</span> <span class="st">"new_score_i"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">new_model</span><span class="op">$</span><span class="va">data</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights score_i new_score_i</span>
<span class="co">#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556   0.067       0.082</span>
<span class="co">#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500   0.729       0.715</span>
<span class="co">#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973   0.491       0.571</span></code></pre></div>
<p>If the purpose is to gather the scores columns from a cascade of models, and in order to avoid confusion, it is expedient to name each scores column with reference to its very model:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"bv"</span>,
                   score_i_heading <span class="op">=</span> <span class="st">"score_i_1"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">$</span><span class="va">data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"ds"</span>,
                   score_i_heading <span class="op">=</span> <span class="st">"score_i_2"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="va">model_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">$</span><span class="va">data</span>, <span class="va">items_sel</span>, wa <span class="op">=</span> <span class="st">"cz"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>,
                   score_i_heading <span class="op">=</span> <span class="st">"score_i_3"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">model_3</span><span class="op">$</span><span class="va">data</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   id y1 y2 y3  y4    y5    y6    y7 sampl_weights score_i_1 score_i_2 score_i_3</span>
<span class="co">#&gt; 1  1  0  0  0 0.0 0.369 0.174 0.196         0.556     0.082     0.082     0.103</span>
<span class="co">#&gt; 2  2  1  0  1 0.2 0.762 0.832 1.000         1.500     0.788     0.715     0.786</span>
<span class="co">#&gt; 3  3  0  1  1 0.4 0.708 0.775 0.833         0.973     0.644     0.571     0.641</span></code></pre></div>
</div>
<div id="two-level-model" class="section level2">
<h2 class="hasAnchor">
<a href="#two-level-model" class="anchor"></a>Two-Level Deprivation Model</h2>
<p>To demonstrate a two-level deprivation model with the Betti-Verma double weighting rule operating at both levels we use the dataset <code>MSNA_HC</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="st">"MSNA_HC"</span><span class="op">)</span></code></pre></div>
<p>Check the dataset structure…</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">MSNA_HC</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    2855 obs. of  15 variables:</span>
<span class="co">#&gt;  $ id             : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ sampl_weights  : num  0.636 1.086 0.657 0.657 1.086 ...</span>
<span class="co">#&gt;  $ upazilla       : chr  "Teknaf" "Teknaf" "Teknaf" "Teknaf" ...</span>
<span class="co">#&gt;  $ union          : chr  "Teknaf Paurashava" "Nhilla" "Baharchara" "Baharchara" ...</span>
<span class="co">#&gt;  $ hhh_gender     : chr  "male" "male" "male" "male" ...</span>
<span class="co">#&gt;  $ ls_1_food      : num  0.518 0.728 0.362 0.554 0.464 ...</span>
<span class="co">#&gt;  $ ls_2_livelihood: num  0.5 0.5 0.5 0.5 0.75 1 0.75 0.75 0.5 1 ...</span>
<span class="co">#&gt;  $ ls_3_shelter   : num  0.9137 0.3204 0.3204 0.0696 0.3204 ...</span>
<span class="co">#&gt;  $ water_1        : int  0 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">#&gt;  $ water_2        : int  0 0 0 0 1 0 0 1 0 1 ...</span>
<span class="co">#&gt;  $ water_3        : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ sanit_1        : int  1 1 0 1 1 1 1 1 0 1 ...</span>
<span class="co">#&gt;  $ sanit_2        : int  0 0 0 0 0 0 0 1 1 1 ...</span>
<span class="co">#&gt;  $ sanit_3        : int  1 1 0 0 0 1 0 1 0 0 ...</span>
<span class="co">#&gt;  $ sanit_4        : int  0 0 0 1 0 0 0 1 0 0 ...</span></code></pre></div>
<p><a name="msna_hc_items_distribution"></a> … and the distribution of every item:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items</span> <span class="op">&lt;-</span> <span class="va">MSNA_HC</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">ls_1_food</span><span class="op">:</span><span class="va">sanit_4</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># all items</span>

<span class="va">MSNA_HC</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">items</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"item"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">item</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Item Distributions"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig8-1.png" width="680.314960629921"></p>
<p>At the lower level (<code>level_1</code>), the seven binary WASH (Water, Sanitation and Hygiene) items will be aggregated to a continuous WASH deprivation indicator, <code>ls_4_WASH</code>. To equalize subsector contributions, water (prefix <code>water_</code>) and sanitation (prefix <code>sanit_</code>) items are grouped in different dimensions.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># grouping items in dimensions</span>
<span class="va">items_level_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"water"</span> <span class="op">=</span> <span class="fu">str_subset</span><span class="op">(</span><span class="va">items</span>, <span class="st">"^water_"</span><span class="op">)</span>, <span class="st">"sanit"</span> <span class="op">=</span> <span class="fu">str_subset</span><span class="op">(</span><span class="va">items</span>, <span class="st">"^sanit_"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><a name="corr_wash_items"></a></p>
<p>Check correlation type of items pairs according to the <a href="#mixed_rule"><code>mixed</code>-rule</a></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/corr_mat.html">corr_mat</a></span><span class="op">(</span><span class="va">MSNA_HC</span>, <span class="va">items_level_1</span>, output <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span> <span class="co"># corr_type (default) = "mixed"</span>
<span class="co">#&gt; $water</span>
<span class="co">#&gt;         water_1      water_2      water_3     </span>
<span class="co">#&gt; water_1 "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; water_2 "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; water_3 "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sanit</span>
<span class="co">#&gt;         sanit_1      sanit_2      sanit_3      sanit_4     </span>
<span class="co">#&gt; sanit_1 "polychoric" "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; sanit_2 "polychoric" "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; sanit_3 "polychoric" "polychoric" "polychoric" "polychoric"</span>
<span class="co">#&gt; sanit_4 "polychoric" "polychoric" "polychoric" "polychoric"</span>

<span class="co"># all correlations are of type "polychoric"</span></code></pre></div>
<p>In this humanitarian context, there is no basis to consider one or the other water or sanitation problem more or less important on the basis of their different prevalence. Therefore, in aggregating the seven binary water and sanitation items, for the first weighting factor we set the argument <code>wa</code> = <code>"equal"</code>. However, we keep redundancy control active. That is, the second weighting factor <code>wb</code> = <code>"mixed"</code> has the effect of reducing weights on more redundant items. (Note that because <a href="#msna_hc_items_distribution">all WASH items are binary 0 or 1</a>, choosing <a href="#corr_wash_items"><code>"mixed"</code> results in <code>"polychoric"</code> for all item pairs</a>. <code>wb</code> = <code>"diagonal"</code> would be neutral to redundancy; and <code>wb</code> = <code>"pearson"</code> would underrate the strength of correlations between binary items).</p>
<p>This model returns the deprivation scores as a column <code>"ls_4_WASH"</code> (argument <code>score_i_heading</code>) merged to the <code>output</code> element <code>"data"</code>:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_level_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">MSNA_HC</span>, <span class="va">items_level_1</span>, <span class="st">"sampl_weights"</span>, wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>,
                         score_i_heading <span class="op">=</span> <span class="st">"ls_4_WASH"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="co"># check structure of output element data</span>
<span class="va">model_level_1</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    2855 obs. of  16 variables:</span>
<span class="co">#&gt;  $ id             : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ sampl_weights  : num  0.636 1.086 0.657 0.657 1.086 ...</span>
<span class="co">#&gt;  $ upazilla       : chr  "Teknaf" "Teknaf" "Teknaf" "Teknaf" ...</span>
<span class="co">#&gt;  $ union          : chr  "Teknaf Paurashava" "Nhilla" "Baharchara" "Baharchara" ...</span>
<span class="co">#&gt;  $ hhh_gender     : chr  "male" "male" "male" "male" ...</span>
<span class="co">#&gt;  $ ls_1_food      : num  0.518 0.728 0.362 0.554 0.464 ...</span>
<span class="co">#&gt;  $ ls_2_livelihood: num  0.5 0.5 0.5 0.5 0.75 1 0.75 0.75 0.5 1 ...</span>
<span class="co">#&gt;  $ ls_3_shelter   : num  0.9137 0.3204 0.3204 0.0696 0.3204 ...</span>
<span class="co">#&gt;  $ water_1        : int  0 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">#&gt;  $ water_2        : int  0 0 0 0 1 0 0 1 0 1 ...</span>
<span class="co">#&gt;  $ water_3        : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ sanit_1        : int  1 1 0 1 1 1 1 1 0 1 ...</span>
<span class="co">#&gt;  $ sanit_2        : int  0 0 0 0 0 0 0 1 1 1 ...</span>
<span class="co">#&gt;  $ sanit_3        : int  1 1 0 0 0 1 0 1 0 0 ...</span>
<span class="co">#&gt;  $ sanit_4        : int  0 0 0 1 0 0 0 1 0 0 ...</span>
<span class="co">#&gt;  $ ls_4_WASH      : num  0.237 0.237 0 0.267 0.282 ...</span></code></pre></div>
<p>At the second level (<code>level_2</code>), in the aggregation of the four continuous living-standards-indicators (<code>ls_1_food</code>, <code>ls_2_livelihood</code>, <code>ls_3_shelter</code>, <code>ls_4_WASH</code>), the default Betti-Verma method is used, by setting <code>method</code> = <code>"bv"</code>. This activates both mechanisms of the double-weighting scheme - rewarding more discriminating indicators with higher weights, and penalizing redundant ones with lower weights.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save the "data" returned by the lower level model</span>
<span class="va">MSNA_HC_2</span> <span class="op">&lt;-</span> <span class="va">model_level_1</span><span class="op">$</span><span class="va">data</span>
<span class="co"># save all column headings with prefix ls_ (living standards) as items of the higher level</span>
<span class="op">(</span><span class="va">items_level_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">MSNA_HC_2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">str_subset</span><span class="op">(</span><span class="st">"^ls_"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "ls_1_food"       "ls_2_livelihood" "ls_3_shelter"    "ls_4_WASH"</span>
<span class="co"># save higher level model</span>
<span class="va">model_level_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">MSNA_HC_2</span>, <span class="va">items_level_2</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></code></pre></div>
<p>Compare the items and scores of the second level:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_level_2</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">items_level_2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"item"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">score_i</span>, col <span class="op">=</span> <span class="va">hhh_gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">item</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"ls model (2nd level): items vs. score_i"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gender of\nhousehold\nhead"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig9-1.png" width="680.314960629921"></p>
<p>Since the scores are returned merged to the original data it is easy to compare them to variables with potential explanatory value. Thus, we ask: Do union (commune) and gender of household head have any predictive value for the distribution of deprivation scores?</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_level_2</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">union</span>, y <span class="op">=</span> <span class="va">score_i</span>, fill <span class="op">=</span> <span class="va">hhh_gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_boxplot</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"union (commune), gender of household head vs. score_i"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gender of\nhousehold\nhead"</span>, x <span class="op">=</span> <span class="st">"union (commune)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>,
    x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0</span>,
    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"female: n = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">model_level_2</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">hhh_gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>,
    x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">0.95</span>, hjust <span class="op">=</span> <span class="fl">0</span>,
    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"male: n = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">model_level_2</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">hhh_gender</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig10-1.png" width="680.314960629921"></p>
<p>Of particular note are the gender differences (much higher median deprivation scores for female-headed households) in Palong Khali Union and in the Teknaf Upazila headquarter Union (Paurashava).</p>
</div>
<div id="handling-missing-values" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-missing-values" class="anchor"></a>Handling Missing Values</h2>
<p><code><a href="../reference/mdepriv.html">mdepriv()</a></code> does not allow any missing values among variables specified by the arguments <code>items</code> or <code>sampling_weights</code>. In other words, <code><a href="../reference/mdepriv.html">mdepriv()</a></code> does not automatically under the hood filter out such observations from the input <code>data</code>.</p>
<p>Although inconvenient, the absence of such tacit filtering is for a good reason. In multi-level models that use different variables as <code>items</code> at each level, there is the potential of sequentially decreasing numbers of complete observations. The user, aware of this risk, should filter out observations with missing values in any of the variables entered in the whole model. This step should be taken prior to running the model at the first level.</p>
<p>To demonstrate the handling of missing values, we use the same specification of arguments as in the <a href="#two-level-model">above two-level-deprivation model</a>, but a dataset containing missing values among items selected for the 1<sup>st</sup> and 2<sup>nd</sup> level as well as among the sampling weights.</p>
<p>We recall the items and sampling weight specification:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">items_level_1</span>
<span class="co">#&gt; $water</span>
<span class="co">#&gt; [1] "water_1" "water_2" "water_3"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sanit</span>
<span class="co">#&gt; [1] "sanit_1" "sanit_2" "sanit_3" "sanit_4"</span>

<span class="va">items_level_2</span>
<span class="co">#&gt; [1] "ls_1_food"       "ls_2_livelihood" "ls_3_shelter"    "ls_4_WASH"</span>
<span class="co"># As noted earlier, the 4th item holds the scores from the model's 1st level</span>

<span class="st">"sampl_weights"</span>
<span class="co">#&gt; [1] "sampl_weights"</span></code></pre></div>
<p>We gather the names of the variables (arguments <code>items</code> and <code>sampling_weights</code>) which require complete values in order for <code><a href="../reference/mdepriv.html">mdepriv()</a></code> to execute the model:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vars_required_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="va">items_level_1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">items_level_2</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span>, <span class="co"># without "ls_4_WASH"</span>
  <span class="st">"sampl_weights"</span>
  <span class="op">)</span></code></pre></div>
<p>For the purpose of demonstration some of the values of those variables are replaced with <code>NA</code> (= missing values):</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSNA_HC_with_NA</span> <span class="op">&lt;-</span> <span class="va">MSNA_HC</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">vars_required_complete</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">MSNA_HC_with_NA</span><span class="op">[</span><span class="va">i</span> <span class="op">*</span> <span class="fl">10</span> <span class="op">+</span> <span class="op">(</span><span class="op">-</span><span class="fl">9</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span>, <span class="va">vars_required_complete</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="op">}</span></code></pre></div>
<p>Now we try to run the first-level model. <code><a href="../reference/mdepriv.html">mdepriv()</a></code> responds with this error message:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_level_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span>, <span class="va">items_level_1</span>, <span class="st">"sampl_weights"</span>,
                         wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>,
                         score_i_heading <span class="op">=</span> <span class="st">"ls_4_WASH"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="co">#&gt; Error: The argument 'items' contains the following variables with NA: "water_1", "water_2", "water_3", "sanit_1", "sanit_2", "sanit_3" and "sanit_4". The argument 'items' does not allow any NA-values.</span></code></pre></div>
<p>One might be tempted to filter out only those records from the input dataset (argument <code>data</code>) with <code>NA</code>s in the variables that the error message pointed out. However, that would not be enough; the error message addresses only the use of items in the model’s 1<sup>st</sup> level. The items of the 2<sup>nd</sup> level and the sampling weights, too need to be inspected for <code>NA</code>s:</p>
<p><a name="vis_dat"></a></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSNA_HC_with_NA</span> <span class="op">%&gt;%</span>
  <span class="co"># select(all_of(vars_required_complete)) %&gt;%</span>
  <span class="co"># uncomment above line if only variables required to be complete should be visualized</span>
  <span class="fu"><a href="http://visdat.njtierney.com//reference/vis_dat.html">vis_dat</a></span><span class="op">(</span>sort_type <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig_mis_val_1-1.png" width="529.133858267717"></p>
<p>The <a href="#vis_dat">above graphic</a> reveals missing values also in the 2<sup>nd</sup>-level items (<code>ls_1_food</code>, <code>ls_2_livelihood</code>, <code>ls_3_shelter</code>) as well as in the sampling weights.</p>
<p>Hint: If there are only relatively few missing values / <code>NA</code>s, the function <code><a href="http://visdat.njtierney.com//reference/vis_dat.html">visdat::vis_dat()</a></code> may not be the best option to visualize them. Instead you could try out <code><a href="http://visdat.njtierney.com//reference/vis_miss.html">visdat::vis_miss()</a></code>. This function tags the percentage of missing values in each variable to its label and the percentages of incomplete observations across all selected variables to the legend. (<a href="#vis_miss">s. below</a>).</p>
<p>If we intend to link the scores obtained with <code><a href="../reference/mdepriv.html">mdepriv()</a></code> back to each observation within the original dataset containing <code>NA</code>s among the specified <code>items</code> and/or <code>sampling_weights</code> a variable column with a unique value for each row as a valid identifier for each record is required. Thus we check if <code>id</code> is a valid identifier:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">n_distinct</span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">$</span><span class="va">id</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>If that is not the case, a new valid identifier column must be added to the dataset:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MSNA_HC_with_NA$id_new &lt;- 1:nrow(MSNA_HC_with_NA)</span></code></pre></div>
<p>Now we filter for records with complete values among the items and sampling weights:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSNA_HC_filtered</span> <span class="op">&lt;-</span> <span class="va">MSNA_HC_with_NA</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">.</span><span class="op">[</span><span class="va">vars_required_complete</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>After filtering, the model (here one with two levels) works as usual:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save lower level model</span>
<span class="va">model_level_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">MSNA_HC_filtered</span>, <span class="va">items_level_1</span>, <span class="st">"sampl_weights"</span>,
                         wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>,
                         score_i_heading <span class="op">=</span> <span class="st">"ls_4_WASH"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>

<span class="co"># save the "data" returned by the lower level model</span>
<span class="va">MSNA_HC_filtered_2</span> <span class="op">&lt;-</span> <span class="va">model_level_1</span><span class="op">$</span><span class="va">data</span>

<span class="co"># save higher level model</span>
<span class="va">model_level_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">MSNA_HC_filtered_2</span>, <span class="va">items_level_2</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></code></pre></div>
<p>Now we can merge back:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_4_join</span> <span class="op">&lt;-</span> <span class="va">model_level_2</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_4_join</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;    id ls_4_WASH   score_i</span>
<span class="co">#&gt; 1 136 0.3456620 0.5476448</span>
<span class="co">#&gt; 2 137 0.2323856 0.3854030</span>
<span class="co">#&gt; 3 138 0.2221500 0.3557398</span>

<span class="va">MSNA_HC_with_NA</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span>, <span class="va">data_4_join</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></code></pre></div>
<p>Our demonstration is done and we check the outcome with <code><a href="http://visdat.njtierney.com//reference/vis_dat.html">visdat::vis_dat()</a></code>. The missing values in the calculated score variables <code>ls_4_WASH</code> (1<sup>st</sup> level) and <code>score_i</code> (2<sup>nd</sup> level) correspond to observations containing at least one missing value among the applied <code>items</code> and <code>sampling_weights</code>:</p>
<p><a name="vis_miss"></a></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="http://visdat.njtierney.com//reference/vis_miss.html">vis_miss</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig_mis_val_2-1.png" width="566.929133858268"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">)</span> <span class="co"># number of observations in original dataset</span>
<span class="co">#&gt; [1] 2855</span>

<span class="va">model_level_2</span><span class="op">$</span><span class="va">summary_scores</span> <span class="co"># scores summary of higher / 2nd level</span>
<span class="co">#&gt;   N_Obs.      Mean Std._Dev.        Min       Max</span>
<span class="co">#&gt; 1   2720 0.3955291 0.1512961 0.07108284 0.9606823</span>

<span class="co"># percentage of observations with valid input and calculated scores</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">model_level_2</span><span class="op">$</span><span class="va">summary_scores</span><span class="op">$</span><span class="va">N_Obs.</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">MSNA_HC_with_NA</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] 95.27</span></code></pre></div>
<p>The 95.27% are the complement to the 4.73% missing scores as shown in <a href="#vis_miss">the above plot</a>.</p>
</div>
<div id="multiple-models-in-a-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-models-in-a-data-frame" class="anchor"></a>Multiple Models in a data.frame</h2>
<p>The handling of returns of multiple <code>mdepriv</code> models, which each comes as a <code>list</code>, can become cumbersome. We make this more convenient by combining the <code>list</code>s in a <code>data.frame</code>. Every model becomes a row and the different <code>output</code> elements are gathered as columns/variables.</p>
<p>Saving some models’ <code>output</code>s as <code>list</code>s: <a name="models_with_without_dim"></a></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outputs</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"summary_by_dimension"</span><span class="op">)</span>
<span class="co"># explicitly add the "summary_by_dimension" table so it's included also if no dimensions are specified</span>
<span class="va">items_sel</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span> <span class="co"># a selection of items</span>
<span class="va">dim</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y5"</span>, <span class="st">"y6"</span>, <span class="st">"y7"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># a grouping of items in dimensions</span>
<span class="va">w_expertise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>
<span class="co"># expertise-base weights for (grouped) items</span>

<span class="co"># models with no dimensions specified</span>
<span class="va">bv</span>            <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span>
<span class="va">equal</span>         <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, method <span class="op">=</span> <span class="st">"equal"</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span>
<span class="va">bv_diagonal</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, wa <span class="op">=</span> <span class="st">"bv"</span>, wb <span class="op">=</span> <span class="st">"diagonal"</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span>
<span class="va">equal_mixed</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">items_sel</span>, wa <span class="op">=</span> <span class="st">"equal"</span>, wb <span class="op">=</span> <span class="st">"mixed"</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span>
<span class="co"># models with dimension specification</span>
<span class="va">bv_dim</span>        <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">dim</span>, method <span class="op">=</span> <span class="st">"bv"</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span>
<span class="va">expertise_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdepriv.html">mdepriv</a></span><span class="op">(</span><span class="va">simul_data</span>, <span class="va">dim</span>, user_def_weights <span class="op">=</span> <span class="va">w_expertise</span>, output <span class="op">=</span> <span class="va">outputs</span><span class="op">)</span></code></pre></div>
<p>Combining the <code>list</code>s to a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">bv</span>, <span class="va">equal</span>, <span class="va">bv_diagonal</span>, <span class="va">equal_mixed</span>, <span class="va">bv_dim</span>, <span class="va">expertise_dim</span><span class="op">)</span>
<span class="co"># gather all the models' returns in one list</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bv"</span>, <span class="st">"equal"</span>, <span class="st">"bv_diagonal"</span>, <span class="st">"equal_mixed"</span>, <span class="st">"bv_dim"</span>, <span class="st">"expertise_dim"</span><span class="op">)</span>
<span class="co"># name the list with reference to the models</span>

<span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">l</span><span class="op">)</span>
<span class="co"># turn each model-output / list-element into a row of a matrix</span>
<span class="fu">is</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>
<span class="co">#&gt; [1] "matrix"    "array"     "structure" "vector"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="co"># turn the matrix into a data.frame/tibble</span>
<span class="va">df</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span>
<span class="co"># add a column for model names as factor ordered by first appearance</span>
<span class="fu">is</span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame" "list"       "oldClass"  </span>
<span class="co">#&gt; [6] "vector"</span></code></pre></div>
<p>For more insight into this <code>data.frame</code> use this code:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  class_of_variable <span class="op">=</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">df</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>,
  classes_within_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,
    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
      <span class="fu">map_chr</span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" or "</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;                             class_of_variable classes_within_variable</span>
<span class="co">#&gt; weighting_scheme                         list               character</span>
<span class="co">#&gt; aggregate_deprivation_level              list                 numeric</span>
<span class="co">#&gt; summary_by_dimension                     list              data.frame</span>
<span class="co">#&gt; summary_by_item                          list              data.frame</span>
<span class="co">#&gt; summary_scores                           list              data.frame</span>
<span class="co">#&gt; score_i                                  list                 numeric</span>
<span class="co">#&gt; sum_sampling_weights                     list                 numeric</span>
<span class="co">#&gt; data                                     list              data.frame</span>
<span class="co">#&gt; items                                    list                    list</span>
<span class="co">#&gt; sampling_weights                         list               character</span>
<span class="co">#&gt; wa                                       list               character</span>
<span class="co">#&gt; wb                                       list               character</span>
<span class="co">#&gt; rhoH                                     list                 numeric</span>
<span class="co">#&gt; user_def_weights                         list         logical or list</span>
<span class="co">#&gt; score_i_heading                          list               character</span>
<span class="co">#&gt; model                                  factor                  factor</span></code></pre></div>
<p>Except for <code>"model"</code>, all variables are of the class <code>list</code>. <a href="#tab_output">As expected</a>, only the columns/outputs <code>"user_def_weights"</code> and <code>"user_def_weights"</code> are at their core <code>list</code>s, respectively <code>list</code>s or single logical NAs. The rest consists either of single values, of vectors or of <code>data.frame</code>s, which are easy to compile to an overall <code>data.frames</code> with <code><a href="https://dplyr.tidyverse.org/reference/bind.html">dplyr::bind_rows()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/nest.html">tidyr::unnest()</a></code>.</p>
<p>Select and use model returns of interest saved in the <code>data.frame</code>:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># compile a single column/variable consisting at its core of data.frames</span>
<span class="fu">bind_rows</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">summary_scores</span><span class="op">)</span>
<span class="co">#&gt;   N_Obs.      Mean Std._Dev.        Min       Max</span>
<span class="co">#&gt; 1    100 0.4321696 0.2013452 0.04912143 0.9603282</span>
<span class="co">#&gt; 2    100 0.4801443 0.1905186 0.10528571 0.9421429</span>
<span class="co">#&gt; 3    100 0.3717380 0.2273104 0.03950519 0.9744880</span>
<span class="co">#&gt; 4    100 0.5019077 0.1798727 0.10929403 0.9239400</span>
<span class="co">#&gt; 5    100 0.4049227 0.2040694 0.06620614 0.9555567</span>
<span class="co">#&gt; 6    100 0.5085708 0.2159222 0.08426667 0.9595000</span>

<span class="co"># compile several variables to a data.frame ...</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"wa"</span>, <span class="st">"wb"</span>, <span class="st">"rhoH"</span>, <span class="st">"summary_scores"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unnest</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 9</span>
<span class="co">#&gt;   model         wa    wb         rhoH N_Obs.  Mean Std._Dev.    Min   Max</span>
<span class="co">#&gt;   &lt;fct&gt;         &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 bv            bv    mixed     0.656    100 0.432     0.201 0.0491 0.960</span>
<span class="co">#&gt; 2 equal         equal diagonal NA        100 0.480     0.191 0.105  0.942</span>
<span class="co">#&gt; 3 bv_diagonal   bv    diagonal NA        100 0.372     0.227 0.0395 0.974</span>
<span class="co">#&gt; 4 equal_mixed   equal mixed     0.656    100 0.502     0.180 0.109  0.924</span>
<span class="co">#&gt; 5 bv_dim        bv    mixed     0.656    100 0.405     0.204 0.0662 0.956</span>
<span class="co">#&gt; 6 expertise_dim &lt;NA&gt;  &lt;NA&gt;     NA        100 0.509     0.216 0.0843 0.960</span>

<span class="co"># compile and plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span> <span class="co"># reduce plotting text</span>
<span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"aggregate_deprivation_level"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">aggregate_deprivation_level</span> <span class="op">~</span> <span class="va">model</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig11-1.png" width="504"></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># and once again compile and plot</span>
<span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"score_i"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">score_i</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">model</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Distributions of deprivation scores, by model"</span><span class="op">)</span></code></pre></div>
<p><img src="mdepriv_get_started_files/figure-html/Fig12-1.png" width="680.314960629921"></p>
</div>
<div id="acknowledgement" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgement" class="anchor"></a>Acknowledgement</h2>
<p>We thank Philippe Van Kerm, who, together with Maria Noel Pi Alperin, both with the Luxembourg Institute of Socio-Economic Research (LISER, formerly CEPS/INSTEAD, Luxembourg), wrote the code and documentation of the Stata command -mdepriv-, for encouraging us to translate it to R. We thank Patrice Chataigner, OkularAnalytics, Geneva, for moral and financial support. We thank Edouard Legoupil, UNHCR, for moral and technical support.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Betti, G. &amp; Verma, V. K. (1998), ‘Measuring the degree of poverty in a dynamic and comparative context: a multi-dimensional approach using fuzzy set theory’, Working Paper 22, Dipartimento di Metodi Quantitativi, Universita di Siena. [A similar version is available at <a href="https://www.researchgate.net/profile/Gianni_Betti/publication/241227568_Measuring_the_degree_of_poverty_in_a_dynamic_and_comparative_context_A_multi-dimensional_approach_using_fuzzy_set_theory/links/00b49533307370c675000000/Measuring-the-degree-of-poverty-in-a-dynamic-and-comparative-context-A-multi-dimensional-approach-using-fuzzy-set-theory.pdf" class="uri">https://www.researchgate.net/profile/Gianni_Betti/publication/241227568_Measuring_the_degree_of_poverty_in_a_dynamic_and_comparative_context_A_multi-dimensional_approach_using_fuzzy_set_theory/links/00b49533307370c675000000/Measuring-the-degree-of-poverty-in-a-dynamic-and-comparative-context-A-multi-dimensional-approach-using-fuzzy-set-theory.pdf</a> (2019-12-05)]</p>
<p>Cerioli, A. and S. Zani (1990). A fuzzy approach to the measurement of poverty. Income and wealth distribution, inequality and poverty. C. Dagum and M. Zenga. Urdorf, Switzerland, Springer: 272-284.</p>
<p>Desai, M. &amp; Shah, A. (1988), ‘An econometric approach to the measurement of poverty’, Oxford Economic Papers, 40(3):505-522.</p>
<p>Lemmi, A. A. and G. Betti, Eds. (2006). Fuzzy set approach to multidimensional poverty measurement, Springer Science &amp; Business Media.</p>
<p>Pi Alperin, M. N. &amp; Van Kerm, P. (2009), ‘mdepriv - Synthetic indicators of multiple deprivation’, v2.0 (revised March 2014), CEPS/INSTEAD, Esch/Alzette, Luxembourg. <a href="http://medim.ceps.lu/stata/mdepriv_v3.pdf" class="uri">http://medim.ceps.lu/stata/mdepriv_v3.pdf</a> (2020-01-02).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Attilio Benini, Aldo Benini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
